function TimerWidget(n,t,i,r){try{TimerWidget.prototype.IsStaticMode=r,TimerWidget.prototype.IsPaused=!0,TimerWidget.hours=0,TimerWidget.minutes=0,TimerWidget.seconds=0,TimerWidget.PaidSessionTimer,TimerWidget.ErrorCallback=t,TimerWidget.PaidSessionTimerControl=$("#"+n),TimerWidget.PaidSessionTimerControl.readOnly=!0,TimerWidget.HideHours=!1,i&&(TimerWidget.HideHours=!0)}catch(u){TimerWidget.ErrorCallback(u)}}function getJsonPropertiesCount(n){var t=0,i;for(i in n)n.hasOwnProperty(i)&&++t;return t}function formatJsonData(n){var r=getJsonPropertiesCount(n),t="",i=0;return $.each(n,function(n,u){t+=n+", "+u,i++,i!=r&&(t+=", ")}),t}function LogEvent(n,t){this.loggingLevel=n,this.message=t}function Login(n){var i;try{i=function(){var n={};if(typeof UAParser!="undefined")try{n=(new UAParser).getResult()}catch(t){}return n},Login.JsonMsg={MSG:{en:"000",HEADER:{msgID:"2035",seqNum:"0",appID:"3083",source:"0",dest:"0",sessionID:"0"},DATA:{GUID:"",VER:"",userAgentDetails:i()}}},Login.JsonMsg.MSG.DATA.GUID=n;var r=navigator.userAgent.split(" "),u=r.length,f=r[u-1],t="Unknown OS";navigator.appVersion.indexOf("Win")!=-1&&(t="Windows"),navigator.appVersion.indexOf("Mac")!=-1&&(t="MacOS"),navigator.appVersion.indexOf("X11")!=-1&&(t="UNIX"),navigator.appVersion.indexOf("Linux")!=-1&&(t="Linux"),Login.JsonMsg.MSG.DATA.VER=f+" "+t+" 1,0,0",Login.BAH=0}catch(e){MainConnection.prototype.SendError(e.message)}}function Session(){try{Session.JsonStartTypingMsg={MSG:{en:"000",HEADER:{msgID:"1084",seqNum:"0",appID:"3083",source:"0",dest:"0",sessionID:"0"},DATA:{TEXT:"",PASTE:"0"}}},Session.JsonHireMsg={MSG:{en:"000",HEADER:{msgID:"1086",seqNum:"0",appID:"3083",source:"0",dest:"0",sessionID:"0"},DATA:null}},Session.JsonQuitMsg={MSG:{en:"000",HEADER:{msgID:"1078",seqNum:"0",appID:"3083",source:"0",dest:"0",sessionID:"0"},DATA:null}},Session.JsonOnloadBillingFormMsg={MSG:{en:"000",HEADER:{msgID:"2073",seqNum:"0",appID:"3083",source:"0",dest:"0",sessionID:"0"},DATA:null}},Session.JsonBillingInfoWasVerifiedMsg={MSG:{en:"000",HEADER:{msgID:"2076",seqNum:"0",appID:"3083",source:"0",dest:"0",sessionID:"0"},DATA:{transactionID:""}}},Session.JsonBillingInfoWasVerifiedMsg={MSG:{en:"000",HEADER:{msgID:"2075",seqNum:"0",appID:"3083",source:"0",dest:"0",sessionID:"0"},DATA:null}},Session.JsonStartTypingMsg={MSG:{en:"000",HEADER:{msgID:"2082",seqNum:"0",appID:"3083",source:"0",dest:"0",sessionID:"0"},DATA:null}},Session.JsonStartTypingMsg={MSG:{en:"000",HEADER:{msgID:"2083",seqNum:"0",appID:"3083",source:"0",dest:"0",sessionID:"0"},DATA:null}},Session.SendTextTimer,Session.FreeMinutesTimeout,Session.FreeMinutes=-6000}catch(t){MainConnection.prototype.SendError(t.message)}}function MainConnection(n){try{MainConnection.ws,MainConnection.OpLogin=new Login(n.ApplicationSecureParamsToken),MainConnection.OpSession=new Session(n.ChatServerEvents),MainConnection.IsBAH=n.enableBAH,MainConnection.OperationsMap={1227:MainConnection.OpLogin,1228:MainConnection.OpLogin,2030:MainConnection.OpLogin,2031:MainConnection.OpLogin,2034:MainConnection.OpLogin,2036:MainConnection.OpLogin,2041:MainConnection.OpLogin,1102:MainConnection.OpLogin,2026:MainConnection.OpLogin,1084:MainConnection.OpSession,1085:MainConnection.OpSession,2048:MainConnection.OpSession,2049:MainConnection.OpSession,2073:MainConnection.OpSession,2028:MainConnection.OpSession,1078:MainConnection.OpSession,2027:MainConnection.OpSession,1093:MainConnection.OpSession},MainConnection.ServerAddress=n.HostName,MainConnection.ConsoleTrace=n.bTabletTrace}catch(t){MainConnection.prototype.SendError(t.message)}}function SetPixelTracking(n,t,i,r,u){var f={event:"chathire",userid:n,expid:t,sessionid:i,catid:r,catname:u},e;f=SessionCommonModule.setTransactionEventData(f,i,null,t,null,SessionCommonModule.sessionType.ONLINE_CHAT),dataLayer.push(f),console.log("TagManagerEvent:",f),e=1,RenderPixelTrackingPurchase(n,t,i,r,e),sessionPaid=!0,$("#embed").length>6000&&$.ajax({type:"POST",url:"/WebServices/Ajax/OnlineSessionTrackingService.svc/SaveSessionTrafficParameters",data:JSON.stringify({sessionId:i,5435530:n}),dataType:"json",contentType:"application/json; charset=utf-8"})}function logChatStarted(){ChatLog.status="ChatStarted",ChatLog.log(ChatLogEvents.expertAgreeToConsult);try{dataLayer.push({event:"expertConnected",expid:ChatLog.data.expertId}),console.log("Eventfired:'expertConnected'")}catch(n){console.log("expertConnected event failed ex: "+n)}}function chatStarted(n,t){t||hideHtmlFallback(),logChatStarted()}function CloseSessionWindow(){window.close()}function fnOpenAskByEmail(n,t,i,r){var u,f,e;i=i.substring(0,39).replace(/ /,"%20"),f="/registration/send-email.aspx?",e="CatID="+n+"&ExpID="+t+"&ExpName="+i+"&StartFrom="+r,u=f+e,window.screen.availHeight<=600&&window.screen.availWidth==800?window.open(u,"message1","scrollbars=yes,height=575,width=570,top=20,left=20,menubar=no,resizable=yes,titlebar=no,toolbar=no,status=no"):window.open(u,"message1","scrollbars=yes,height=575,width=570,top=20,left=20,menubar=no,resizable=yes,titlebar=no,toolbar=no,status=no")}function reconect(){document.location=document.location}var dateFormat,TextType,ExpertStatusServiceModule,ChatType,LogLevel,TagManagerHelper;(function(n){var i=window.Cookies,t=window.Cookies=n();t.noConflict=function(){return window.Cookies=i,t}})(function(){function n(){for(var n=0,r={},t,i;n<arguments.length;n++){t=arguments[n];for(i in t)r[i]=t[i]}return r}function t(i){function r(t,u,f){var o,c,l,s,v,e,h;if(typeof document!="undefined"){if(arguments.length>1){f=n({path:"/"},r.defaults,f),typeof f.expires=="number"&&(c=new Date,c.setMilliseconds(c.getMilliseconds()+f.expires*864e5),f.expires=c),f.expires=f.expires?f.expires.toUTCString():"";try{o=JSON.stringify(u),/^[\{\[]/.test(o)&&(u=o)}catch(w){}u=i.write?i.write(u,t):encodeURIComponent(String(u)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),l="";for(s in f)f[s]&&(l+="; "+s,f[s]!==!0)&&(l+="="+f[s]);return document.cookie=t+"="+u+l}t||(o={});for(var y=document.cookie?document.cookie.split("; "):[],p=/(%[0-9A-Z]{2})+/g,a=0;a<y.length;a++){v=y[a].split("="),e=v.slice(1).join("="),this.json||e.charAt(0)!=='"'||(e=e.slice(1,-1));try{if(h=v[0].replace(p,decodeURIComponent),e=i.read?i.read(e,h):i(e,h)||e.replace(p,decodeURIComponent),this.json)try{e=JSON.parse(e)}catch(w){}if(t===h){o=e;break}t||(o[h]=e)}catch(w){}}return o}}return r.set=r,r.get=function(n){return r.call(r,n)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,i){r(t,"",n(i,{expires:-1}))},r.withConverter=t,r}return t(function(){})}),function(n,t,i){function e(i,r,u){var f=t.createElement(i);return r&&(f.id=h+r),u&&(f.style.cssText=u),n(f)}function ai(){return i.innerHeight?i.innerHeight:n(i).height()}function kt(n){var i=c.length,t=(a+n)%i;return t<0?i+t:t}function y(n,t){return Math.round((/%/.test(n)?(t==="x"?d.width():ai())/100:1)*parseInt(n,10))}function pi(n,t){return n.photo||n.photoRegex.test(t)}function wi(n,t){return n.retinaUrl&&i.devicePixelRatio>1?t.replace(n.photoRegex,n.retinaSuffix):t}function bi(n){"contains"in u[0]&&!u[0].contains(n.target)&&(n.stopPropagation(),u.focus())}function ki(){var t,i=n.data(v,b);i==null?(r=n.extend({},gt),console&&console.log&&console.log("Error: cboxElement missing settings object")):r=n.extend({},i);for(t in r)n.isFunction(r[t])&&t.slice(0,2)!=="on"&&(r[t]=r[t].call(v));r.rel=r.rel||v.rel||n(v).data("rel")||"nofollow",r.href=r.href||n(v).attr("href"),r.title=r.title||v.title,typeof r.href=="string"&&(r.href=n.trim(r.href))}function ft(i,r){n(t).trigger(i),w.trigger(i),n.isFunction(r)&&r.call(v)}function dt(i){if(!at){if(v=i,ki(),c=n(v),a=6000,r.rel!=="nofollow"&&(c=n("."+et).filter(function(){var t=n.data(this,b),i;return t&&(i=n(this).data("rel")||t.rel||this.rel),i===r.rel}),a=c.index(v),a===-1&&(c=c.add(v),a=c.length-1)),k.css({opacity:parseFloat(r.opacity),cursor:r.overlayClose?"pointer":"auto",visibility:"visible"}).show(),hi&&u.add(k).removeClass(hi),r.className&&u.add(k).addClass(r.className),hi=r.className,r.closeButton?bt.html(r.close).appendTo(p):bt.appendTo("<div/>"),!tt){if(tt=lt=!0,u.css({visibility:"hidden",display:"block"}),l=e(o,"LoadedContent","width:0; height:0; overflow:hidden"),p.css({width:"",height:""}).append(l),g=ii.height()+fi.height()+p.outerHeight(!0)-p.height(),nt=ri.width()+ui.width()+p.outerWidth(!0)-p.width(),it=l.outerHeight(!0),rt=l.outerWidth(!0),r.w=y(r.initialWidth,"x"),r.h=y(r.initialHeight,"y"),l.css({width:"",height:r.h}),s.position(),ft(gi,r.onOpen),si.add(ei).hide(),u.focus(),r.trapFocus&&t.addEventListener){t.addEventListener("focus",bi,!0);w.one(ti,function(){t.removeEventListener("focus",bi,!0)})}if(r.returnFocus)w.one(ti,function(){n(v).focus()})}ir()}}function di(){!u&&t.body&&(li=!1,d=n(i),u=e(o).attr({id:b,"class":n.support.opacity===!1?h+"IE":"",role:"dialog",tabindex:"-1"}).hide(),k=e(o,"Overlay").hide(),wt=n([e(o,"LoadingOverlay")[0],e(o,"LoadingGraphic")[0]]),ut=e(o,"Wrapper"),p=e(o,"Content").append(ei=e(o,"Title"),oi=e(o,"Current"),ct=n('<button type="button"/>').attr({id:h+"Previous"}),ht=n('<button type="button"/>').attr({id:h+"Next"}),ot=e("button","Slideshow"),wt),bt=n('<button type="button"/>').attr({id:h+"Close"}),ut.append(e(o).append(e(o,"TopLeft"),ii=e(o,"TopCenter"),e(o,"TopRight")),e(o,!1,"clear:left").append(ri=e(o,"MiddleLeft"),p,ui=e(o,"MiddleRight")),e(o,!1,"clear:left").append(e(o,"BottomLeft"),fi=e(o,"BottomCenter"),e(o,"BottomRight"))).find("div div").css({float:"left"}),st=e(o,!1,"position:absolute; width:9999px; visibility:hidden; display:none"),si=ht.add(ct).add(oi).add(ot),n(t.body).append(k,u.append(ut,st)))}function tr(){function i(n){n.which>1||n.shiftKey||n.altKey||n.metaKey||n.ctrlKey||(n.preventDefault(),dt(this))}if(u){if(!li)if(li=!0,ht.click(function(){s.next()}),ct.click(function(){s.prev()}),bt.click(function(){s.close()}),k.click(function(){r.overlayClose&&s.close()}),n(t).bind("keydown."+h,function(n){var t=n.keyCode;tt&&r.escKey&&t===27&&(n.preventDefault(),s.close()),tt&&r.arrowKey&&c[1]&&!n.altKey&&(t===37?(n.preventDefault(),ct.click()):t===39&&(n.preventDefault(),ht.click()))}),n.isFunction(n.fn.on))n(t).on("click."+h,"."+et,i);else n("."+et).live("click."+h,i);return!0}return!1}function ir(){var u,b,p=s.prep,k,d=++ci;if(lt=!0,f=!1,v=c[a],ki(),ft(pt),ft(vt,r.onLoad),r.h=r.height?y(r.height,"y")-it-g:r.innerHeight&&y(r.innerHeight,"y"),r.w=r.width?y(r.width,"x")-rt-nt:r.innerWidth&&y(r.innerWidth,"x"),r.mw=r.w,r.mh=r.h,r.maxWidth&&(r.mw=y(r.maxWidth,"x")-rt-nt,r.mw=r.w&&r.w<r.mw?r.w:r.mw),r.maxHeight&&(r.mh=y(r.maxHeight,"y")-it-g,r.mh=r.h&&r.h<r.mh?r.h:r.mh),u=r.href,vi=setTimeout(function(){wt.show()},100),r.inline){k=e(o).hide().insertBefore(n(u)[0]);w.one(pt,function(){k.replaceWith(l.children())});p(n(u))}else if(r.iframe)p(" ");else if(r.html)p(r.html);else if(pi(r,u)){u=wi(r,u),f=t.createElement("img");n(f).addClass(h+"Photo").bind("error",function(){r.title=!1,p(e(o,"Error").html(r.imgError))}).one("load",function(){var t;d===ci&&(n.each(["alt","longdesc","aria-describedby"],function(t,i){var r=n(v).attr(i)||n(v).attr("data-"+i);r&&f.setAttribute(i,r)}),r.retinaImage&&i.devicePixelRatio>1&&(f.height=f.height/i.devicePixelRatio,f.width=f.width/i.devicePixelRatio),r.scalePhotos&&(b=function(){f.height-=f.height*t,f.width-=f.width*t},r.mw&&f.width>r.mw&&(t=(f.width-r.mw)/f.width,b()),r.mh&&f.height>r.mh&&(t=(f.height-r.mh)/f.height,b())),r.h&&(f.style.marginTop=Math.max(r.mh-f.height,0)/2+"px"),c[1]&&(r.loop||c[a+1])&&(f.style.cursor="pointer",f.onclick=function(){s.next()}),f.style.width=f.width+"px",f.style.height=f.height+"px",u&&st.load(u,r.data,function(t,i){d===ci&&p(i==="error"?e(o,"Error").html(r.xhrError):n(this).contents())})}var gt={html:!1,photo:!1,iframe:!1,inline:!1,transition:"elastic",speed:300,fadeOut:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,href:!1,title:!1,rel:!1,opacity:.9,preloading:!0,className:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:undefined,closeButton:!0,fastIframe:!0,open:!1,reposition:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",photoRegex:/\.(gif|png|jp(e|g|eg)|bmp|ico|webp)((#|\?).*)?$/i,retinaImage:!1,retinaUrl:!1,retinaSuffix:"@2x.$1",current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",returnFocus:!0,trapFocus:!0,onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1},b="colorbox",h="cbox",et=h+"Element",gi=h+"_open",vt=h+"_load",yt=h+"_complete",ni=h+"_cleanup",ti=h+"_closed",pt=h+"_purge",k,u,ut,p,ii,ri,ui,fi,c,d,l,st,wt,ei,oi,ot,ht,ct,bt,si,w=n("<a/>"),r,g,nt,it,rt,v,a,f,tt,lt,at,vi,s,o="div",hi,ci=0,yi={},li,nr=function(){function t(){clearTimeout(l)}function e(){(r.loop||c[a+1])&&(t(),l=setTimeout(s.next,r.slideshowSpeed))}function v(){ot.html(r.slideshowStop).unbind(i).one(i,y);w.bind(yt,e).bind(vt,t),u.removeClass(n+"off").addClass(n+"on")}function y(){t(),w.unbind(yt,e).unbind(vt,t);ot.html(r.slideshowStart).unbind(i).one(i,function(){s.next(),v()});u.removeClass(n+"on").addClass(n+"off")}function o(){f=!1,ot.hide(),t(),w.unbind(yt,e).unbind(vt,t),u.removeClass(n+"off "+n+"on")}var f,n=h+"Slideshow_",i="click."+h,l;return function(){if(f)r.slideshow||(w.unbind(ni,o),o());else if(r.slideshow&&c[1]){f=!0;w.one(ni,o);r.slideshowAuto?v():y(),ot.show()}}}();n.colorbox||(n(di),s=n.fn[b]=n[b]=function(t,i){var r=this;if(t=t||{},di(),tr()){if(n.isFunction(r))r=n("<a/>"),t.open=!0;else if(!r[0])return r;i&&(t.onComplete=i),r.each(function(){n.data(this,b,n.extend({},n.data(this,b)||gt,t))}).addClass(et),(n.isFunction(t.open)&&t.open.call(r)||t.open)&&dt(r[0])}return r},s.position=function(t,i){function w(){ii[0].style.width=fi[0].style.width=p[0].style.width=parseInt(u[0].style.width,10)-nt+"px",p[0].style.height=ri[0].style.height=ui[0].style.height=parseInt(u[0].style.height,10)-g+"px"}var f,e=0,o=0,c=u.offset(),l,a,v;d.unbind("resize."+h),u.css({top:-9e4,left:-9e4}),l=d.scrollTop(),a=d.scrollLeft(),r.fixed?(c.top-=l,c.left-=a,u.css({position:"fixed"})):(e=l,o=a,u.css({position:"absolute"})),o+=r.right!==!1?Math.max(d.width()-r.w-rt-nt-y(r.right,"x"),0):r.left!==!1?y(r.left,"x"):Math.round(Math.max(d.width()-r.w-rt-nt,0)/2),e+=r.bottom!==!1?Math.max(ai()-r.h-it-g-y(r.bottom,"y"),0):r.top!==!1?y(r.top,"y"):Math.round(Math.max(ai()-r.h-it-g,0)/2),u.css({top:c.top,left:c.left,visibility:"visible"}),ut[0].style.width=ut[0].style.height="9999px",f={width:r.w+rt+nt,height:r.h+it+g,top:e,left:o},t&&(v=0,n.each(f,function(n){if(f[n]!==yi[n]){v=t;return}}),t=v),yi=f,t||u.css(f),u.dequeue().animate(f,{duration:t||0,complete:function(){w(),lt=!1,ut[0].style.width=r.w+rt+nt+"px",ut[0].style.height=r.h+it+g+"px",r.reposition&&setTimeout(function(){d.bind("resize."+h,s.position)},1),i&&i()},step:w})},s.resize=function(n){var t;tt&&(n=n||{},n.width&&(r.w=y(n.width,"x")-rt-nt),n.innerWidth&&(r.w=y(n.innerWidth,"x")),l.css({width:r.w}),n.height&&(r.h=y(n.height,"y")-it-g),n.innerHeight&&(r.h=y(n.innerHeight,"y")),n.innerHeight||n.height||(t=l.scrollTop(),l.css({height:"auto"}),r.h=l.height()),l.css({height:r.h}),t&&l.scrollTop(t),s.position(r.transition==="none"?0:r.speed))},s.prep=function(i){function k(){return r.w=r.w||l.width(),r.w=r.mw&&r.mw<r.w?r.mw:r.w}function d(){return r.h=r.h||l.height(),r.h=r.mh&&r.mh<r.h?r.mh:r.h}if(tt){var v,y=r.transition==="none"?0:r.speed;l.empty().remove(),l=e(o,"LoadedContent").append(i),l.hide().appendTo(st.show()).css({width:k(),overflow:r.scrolling?"auto":"hidden"}).css({height:d()}).prependTo(p),st.hide(),n(f).css({float:"none"}),v=function(){function p(){n.support.opacity===!1&&u[0].style.removeAttribute("filter")}var f=c.length,i,s="frameBorder",v="allowTransparency",o;if(tt){if(o=function(){clearTimeout(vi),wt.hide(),ft(yt,r.onComplete)},ei.html(r.title).add(l).show(),f>1?(typeof r.current=="string"&&oi.html(r.current.replace("{current}",a+1).replace("{total}",f)).show(),ht[r.loop||a<f-1?"show":"hide"]().html(r.next),ct[r.loop||a?"show":"hide"]().html(r.previous),nr(),r.preloading&&n.each([kt(-1),kt(1)],function(){var i,f,u=c[this],r=n.data(u,b);r&&r.href?(i=r.href,n.isFunction(i)&&(i=i.call(u))):i=n(u).attr("href"),i&&pi(r,i)&&(i=wi(r,i),f=t.createElement("img"),f.src=i)})):si.hide(),r.iframe){i=e("iframe")[0],s in i&&(i[s]=0),v in i&&(i[v]="true"),r.scrolling||(i.scrolling="no"),n(i).attr({src:r.href,name:+new Date,"class":h+"Iframe",allowFullScreen:!0,webkitAllowFullScreen:!0,mozallowfullscreen:!0}).one("load",o).appendTo(l);w.one(pt,function(){i.src="//about:blank"});r.fastIframe&&n(i).trigger("load")}else o();r.transition==="fade"?u.fadeTo(y,1,p):p()}},r.transition==="fade"?u.fadeTo(y,0,function(){s.position(0,v)}):s.position(y,v)}},s.next=function(){!lt&&c[1]&&(r.loop||c[a+1])&&(a=kt(1),dt(c[a]))},s.prev=function(){!lt&&c[1]&&(r.loop||a)&&(a=kt(-1),dt(c[a]))},s.close=function(){tt&&!at&&(at=!0,tt=!1,ft(ni,r.onCleanup),d.unbind("."+h),k.fadeTo(r.fadeOut||0,0),u.stop().fadeTo(r.fadeOut||0,0,function(){u.add(k).css({opacity:1,cursor:"auto"}).hide(),ft(pt),l.empty().remove(),setTimeout(function(){at=!1,ft(ti,r.onClosed)},1)}))},s.remove=function(){u&&(u.stop(),n.colorbox.close(),u.stop().remove(),k.remove(),at=!1,u=null,n("."+et).removeData(b).removeClass(et),n(t).unbind("click."+h))},s.element=function(){return n(v)},s.settings=gt)}(jQuery,document,window),dateFormat=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,i=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,r=/[^-+\dA-Z]/g,n=function(n,t){for(n=String(n),t=t||2;n.length<t;)n="0"+n;return n};return function(u,f,e){var h=dateFormat;if(arguments.length!=1||Object.prototype.toString.call(u)!="[object String]"||/\d/.test(u)||(f=u,u=undefined),u=u?new Date(u):new Date,isNaN(u))throw SyntaxError("invalid date");f=String(h.masks[f]||f||h.masks["default"]),f.slice(0,4)=="UTC:"&&(f=f.slice(4),e=!0);var o=e?"getUTC":"get",c=u[o+"Date"](),y=u[o+"Day"](),l=u[o+"Month"](),p=u[o+"FullYear"](),s=u[o+"Hours"](),w=u[o+"Minutes"](),b=u[o+"Seconds"](),a=u[o+"Milliseconds"](),v=e?0:u.getTimezoneOffset(),k={d:c,dd:n(c),ddd:h.i18n.dayNames[y],dddd:h.i18n.dayNames[y+7],m:l+1,mm:n(l+1),mmm:h.i18n.monthNames[l],mmmm:h.i18n.monthNames[l+12],yy:String(p).slice(2),yyyy:p,h:s%12||12,hh:n(s%12||12),H:s,HH:n(s),M:w,MM:n(w),s:b,ss:n(b),l:n(a,3),L:n(a>99?Math.round(a/10):a),t:s<12?"a":"p",tt:s<12?"am":"pm",T:s<12?"A":"P",TT:s<12?"AM":"PM",Z:e?"UTC":(String(u).match(i)||[""]).pop().replace(r,""),o:(v>0?"-":"+")+n(Math.floor(Math.abs(v)/60)*100+Math.abs(v)%60,4),S:["th","st","nd","rd"][c%10>3?0:(c%100-c%10!=10)*c%10]};return f.replace(t,function(n){return n in k?k[n]:n.slice(1,n.length-1)})}}(),dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(n,t){return dateFormat(this,n,t)},function(n,t){typeof define=="function"&&define.amd?define(["jquery"],t):typeof exports!="undefined"?t(require("jquery")):t(n.jQuery)}(this,function(n){"use strict";function f(i){if(t.webkit&&!i)return{height:0,width:0};if(!t.data.outer){var r={border:"none","box-sizing":"content-box",height:"200px",margin:"0",padding:"0",width:"200px"};t.data.inner=n("<div>").css(n.extend({},r)),t.data.outer=n("<div>").css(n.extend({left:"-1000px",overflow:"scroll",position:"absolute",top:"-1000px"},r)).append(t.data.inner).appendTo("body")}return t.data.outer.scrollLeft(1e3).scrollTop(1e3),{height:Math.ceil(t.data.outer.offset().top-t.data.inner.offset().top||0),width:Math.ceil(t.data.outer.offset().left-t.data.inner.offset().left||0)}}function h(){var n=f(!0);return!(n.height||n.width)}function e(n){var t=n.originalEvent;return t.axis&&t.axis===t.HORIZONTAL_AXIS?!1:t.wheelDeltaX?!1:!0}var s=!1,t={data:{index:0,name:"scrollbar"},firefox:/firefox/i.test(navigator.userAgent),macosx:/mac/i.test(navigator.platform),msedge:/edge\/\d+/i.test(navigator.userAgent),msie:/(msie|trident)/i.test(navigator.userAgent),mobile:/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent),overlay:null,scroll:null,scrolls:[],webkit:/webkit/i.test(navigator.userAgent)&&!/edge\/\d+/i.test(navigator.userAgent)},r,u,o,i;t.scrolls.add=function(n){this.remove(n).push(n)},t.scrolls.remove=function(t){while(n.inArray(t,this)>=0)this.splice(n.inArray(t,this),1);return this},r={autoScrollSize:!0,autoUpdate:!0,debug:!1,disableBodyScroll:!1,duration:200,ignoreMobile:!1,ignoreOverlay:!1,isRtl:!1,scrollStep:30,showArrows:!1,stepScrolling:!0,scrollx:null,scrolly:null,onDestroy:null,onFallback:null,onInit:null,onScroll:null,onUpdate:null},u=function(u){t.scroll||(t.overlay=h(),t.scroll=f(),i(),n(window).resize(function(){var r=!1,n;t.scroll&&(t.scroll.height||t.scroll.width)&&(n=f(),(n.height!==t.scroll.height||n.width!==t.scroll.width)&&(t.scroll=n,r=!0)),i(r)})),this.container=u,this.namespace=".scrollbar_"+t.data.index++,this.options=n.extend({},r,window.jQueryScrollbarOptions||{}),this.scrollTo=null,this.scrollx={},this.scrolly={},u.data(t.data.name,this),t.scrolls.add(this)},u.prototype={destroy:function(){if(this.wrapper){this.container.removeData(t.data.name),t.scrolls.remove(this);var i=this.container.scrollLeft(),r=this.container.scrollTop();this.container.insertBefore(this.wrapper).css({height:"",margin:"","max-height":""}).removeClass("scroll-content scroll-scrollx_visible scroll-scrolly_visible").off(this.namespace).scrollLeft(i).scrollTop(r),this.scrollx.scroll.removeClass("scroll-scrollx_visible").find("div").addBack().off(this.namespace),this.scrolly.scroll.removeClass("scroll-scrolly_visible").find("div").addBack().off(this.namespace),this.wrapper.remove(),n(document).add("body").off(this.namespace),n.isFunction(this.options.onDestroy)&&this.options.onDestroy.apply(this,[this.container])}},init:function(i){var o=this,r=this.container,l=this.containerWrapper||r,s=this.namespace,u=n.extend(this.options,i||{}),f={x:this.scrollx,y:this.scrolly},h=this.wrapper,c={},v={scrollLeft:r.scrollLeft(),scrollTop:r.scrollTop()},a;if(t.mobile&&u.ignoreMobile||t.overlay&&u.ignoreOverlay||t.macosx&&!t.webkit)return n.isFunction(u.onFallback)&&u.onFallback.apply(this,[r]),!1;if(h)c={height:"auto","margin-bottom":t.scroll.height*-1+"px","max-height":""},c[u.isRtl?"margin-left":"margin-right"]=t.scroll.width*-1+"px",l.css(c);else{this.wrapper=h=n("<div>").addClass("scroll-wrapper").addClass(r.attr("class")).css("position",r.css("position")==="absolute"?"absolute":"relative").insertBefore(r).append(r),u.isRtl&&h.addClass("scroll--rtl"),r.is("textarea")&&(this.containerWrapper=l=n("<div>").insertBefore(r).append(r),h.addClass("scroll-textarea")),c={height:"auto","margin-bottom":t.scroll.height*-1+"px","max-height":""},c[u.isRtl?"margin-left":"margin-right"]=t.scroll.width*-1+"px",l.addClass("scroll-content").css(c);r.on("scroll"+s,function(){var e=r.scrollLeft(),s=r.scrollTop();if(u.isRtl)switch(!0){case t.firefox:e=Math.abs(e);case t.msedge||t.msie:e=r[0].scrollWidth-r[0].clientWidth-e}n.isFunction(u.onScroll)&&u.onScroll.call(o,{maxScroll:f.y.maxScrollOffset,scroll:s,size:f.y.size,visible:f.y.visible},{maxScroll:f.x.maxScrollOffset,scroll:e,size:f.x.size,visible:f.x.visible}),f.x.isVisible&&f.x.scroll.bar.css("left",e*f.x.kx+"px"),f.y.isVisible&&f.y.scroll.bar.css("top",s*f.y.kx+"px")});h.on("scroll"+s,function(){h.scrollTop(0).scrollLeft(0)});if(u.disableBodyScroll){a=function(n){e(n)?f.y.isVisible&&f.y.mousewheel(n):f.x.isVisible&&f.x.mousewheel(n)};h.on("MozMousePixelScroll"+s,a);h.on("mousewheel"+s,a);if(t.mobile)h.on("touchstart"+s,function(t){var i=t.originalEvent.touches&&t.originalEvent.touches[0]||t,u={pageX:i.pageX,pageY:i.pageY},f={left:r.scrollLeft(),top:r.scrollTop()};n(document).on("touchmove"+s,function(n){var t=n.originalEvent.targetTouches&&n.originalEvent.targetTouches[0]||n;r.scrollLeft(f.left+u.pageX-t.pageX),r.scrollTop(f.top+u.pageY-t.pageY),n.preventDefault()});n(document).on("touchend"+s,function(){n(document).off(s)})})}n.isFunction(u.onInit)&&u.onInit.apply(this,[r])}n.each(f,function(i,h){var y=null,a=1,l=i==="x"?"scrollLeft":"scrollTop",v=u.scrollStep,p=function(){var n=r[l]();r[l](n+v),a==1&&n+v>=c&&(n=r[l]()),a==-1&&n+v<=c&&(n=r[l]()),r[l]()==n&&y&&y()},c=0;if(!h.scroll){h.scroll=o._getScroll(u["scroll"+i]).addClass("scroll-"+i),u.showArrows&&h.scroll.addClass("scroll-element_arrows_visible"),h.mousewheel=function(n){if(!h.isVisible||i==="x"&&e(n))return!0;if(i==="y"&&!e(n))return f.x.mousewheel(n),!0;var t=n.originalEvent.wheelDelta*-1||n.originalEvent.detail,u=h.size-h.visible-h.offset;return t||(i!=="x"||!n.originalEvent.deltaX?i!=="y"||!n.originalEvent.deltaY||(t=n.originalEvent.deltaY*40):t=n.originalEvent.deltaX*40),(t>0&&c<u||t<0&&c>0)&&(c=c+t,c<0&&(c=0),c>u&&(c=u),o.scrollTo=o.scrollTo||{},o.scrollTo[l]=c,setTimeout(function(){o.scrollTo&&(r.stop().animate(o.scrollTo,240,"linear",function(){c=r[l]()}),o.scrollTo=null)},1)),n.preventDefault(),!1};h.scroll.on("MozMousePixelScroll"+s,h.mousewheel).on("mousewheel"+s,h.mousewheel).on("mouseenter"+s,function(){c=r[l]()});h.scroll.find(".scroll-arrow, .scroll-element_track").on("mousedown"+s,function(f){if(f.which!=1)return!0;a=1;var e={eventOffset:f[i==="x"?"pageX":"pageY"],maxScrollValue:h.size-h.visible-h.offset,scrollbarOffset:h.scroll.bar.offset()[i==="x"?"left":"top"],scrollbarSize:h.scroll.bar[i==="x"?"outerWidth":"outerHeight"]()},s=0,w=0;if(n(this).hasClass("scroll-arrow")){if(a=n(this).hasClass("scroll-arrow_more")?1:-1,v=u.scrollStep*a,c=a>0?e.maxScrollValue:0,u.isRtl)switch(!0){case t.firefox:c=a>0?0:e.maxScrollValue*-1}}else a=e.eventOffset>e.scrollbarOffset+e.scrollbarSize?1:e.eventOffset<e.scrollbarOffset?-1:0,i==="x"&&u.isRtl&&(t.msie||t.msedge)&&(a=a*-1),v=Math.round(h.visible*.75)*a,c=e.eventOffset-e.scrollbarOffset-(u.stepScrolling?a==1?e.scrollbarSize:0:Math.round(e.scrollbarSize/2)),c=r[l]()+c/h.kx;return o.scrollTo=o.scrollTo||{},o.scrollTo[l]=u.stepScrolling?r[l]()+v:c,u.stepScrolling&&(y=function(){c=r[l](),clearInterval(w),clearTimeout(s),s=0,w=0},s=setTimeout(function(){w=setInterval(p,40)},u.duration+100)),setTimeout(function(){o.scrollTo&&(r.animate(o.scrollTo,u.duration),o.scrollTo=null)},1),o._handleMouseDown(y,f)});h.scroll.bar.on("mousedown"+s,function(f){if(f.which!=1)return!0;var e=f[i==="x"?"pageX":"pageY"],a=r[l]();h.scroll.addClass("scroll-draggable");n(document).on("mousemove"+s,function(n){var f=parseInt((n[i==="x"?"pageX":"pageY"]-e)/h.kx,10);i==="x"&&u.isRtl&&(t.msie||t.msedge)&&(f=f*-1),r[l](a+f)});return o._handleMouseDown(function(){h.scroll.removeClass("scroll-draggable"),c=r[l]()},f)})}}),n.each(f,function(n,t){var i="scroll-scroll"+n+"_visible",r=n=="x"?f.y:f.x;t.scroll.removeClass(i),r.scroll.removeClass(i),l.removeClass(i)}),n.each(f,function(t,i){n.extend(i,t=="x"?{offset:parseInt(r.css("left"),10)||0,size:r.prop("scrollWidth"),visible:h.width()}:{offset:parseInt(r.css("top"),10)||0,size:r.prop("scrollHeight"),visible:h.height()})}),this._updateScroll("x",this.scrollx),this._updateScroll("y",this.scrolly),n.isFunction(u.onUpdate)&&u.onUpdate.apply(this,[r]),n.each(f,function(n,t){var e=n==="x"?"left":"top",o=n==="x"?"outerWidth":"outerHeight",h=n==="x"?"width":"height",c=parseInt(r.css(e),10)||0,i=t.size,f=t.visible+c,s=t.scroll.size[o]()+(parseInt(t.scroll.size.css(e),10)||0);u.autoScrollSize&&(t.scrollbarSize=parseInt(s*f/i,10),t.scroll.bar.css(h,t.scrollbarSize+"px")),t.scrollbarSize=t.scroll.bar[o](),t.kx=(s-t.scrollbarSize)/(i-f)||1,t.maxScrollOffset=i-f}),r.scrollLeft(v.scrollLeft).scrollTop(v.scrollTop).trigger("scroll")},_getScroll:function(t){var i={advanced:'<div class="scroll-element"><div class="scroll-element_corner"><\/div><div class="scroll-arrow scroll-arrow_less"><\/div><div class="scroll-arrow scroll-arrow_more"><\/div><div class="scroll-element_outer"><div class="scroll-element_size"><\/div><div class="scroll-element_inner-wrapper"><div class="scroll-element_inner scroll-element_track"><div class="scroll-element_inner-bottom"><\/div><\/div><\/div><div class="scroll-bar"><div class="scroll-bar_body"><div class="scroll-bar_body-inner"><\/div><\/div><div class="scroll-bar_bottom"><\/div><div class="scroll-bar_center"><\/div><\/div><\/div><\/div>',simple:'<div class="scroll-element"><div class="scroll-element_outer"><div class="scroll-element_size"><\/div><div class="scroll-element_track"><\/div><div class="scroll-bar"><\/div><\/div><\/div>'};return i[t]&&(t=i[t]),t||(t=i.simple),t=typeof t=="string"?n(t).appendTo(this.wrapper):n(t),n.extend(t,{bar:t.find(".scroll-bar"),size:t.find(".scroll-element_size"),track:t.find(".scroll-element_track")}),t},_handleMouseDown:function(t,i){var r=this.namespace;n(document).on("blur"+r,function(){n(document).add("body").off(r),t&&t()});n(document).on("dragstart"+r,function(n){return n.preventDefault(),!1});n(document).on("mouseup"+r,function(){n(document).add("body").off(r),t&&t()});n("body").on("selectstart"+r,function(n){return n.preventDefault(),!1});return i&&i.preventDefault(),!1},_updateScroll:function(i,r){var u=this.container,o=this.containerWrapper||u,f="scroll-scroll"+i+"_visible",e=i==="x"?this.scrolly:this.scrollx,l=parseInt(this.container.css(i==="x"?"left":"top"),10)||0,s=this.wrapper,c=r.size,h=r.visible+l;r.isVisible=c-h>1,r.isVisible?(r.scroll.addClass(f),e.scroll.addClass(f),o.addClass(f)):(r.scroll.removeClass(f),e.scroll.removeClass(f),o.removeClass(f)),i==="y"&&(u.is("textarea")||c<h?o.css({height:h+t.scroll.height+"px","max-height":"none"}):o.css({"max-height":h+t.scroll.height+"px"})),(r.size!=u.prop("scrollWidth")||e.size!=u.prop("scrollHeight")||r.visible!=s.width()||e.visible!=s.height()||r.offset!=(parseInt(u.css("left"),10)||0)||e.offset!=(parseInt(u.css("top"),10)||0))&&(n.extend(this.scrollx,{offset:parseInt(u.css("left"),10)||0,size:u.prop("scrollWidth"),visible:s.width()}),n.extend(this.scrolly,{offset:parseInt(u.css("top"),10)||0,size:this.container.prop("scrollHeight"),visible:s.height()}),this._updateScroll(i==="x"?"y":"x",e))}},o=u,n.fn.scrollbar=function(i,r){return typeof i!="string"&&(r=i,i="init"),typeof r=="undefined"&&(r=[]),n.isArray(r)||(r=[r]),this.not("body, .scroll-wrapper").each(function(){var f=n(this),u=f.data(t.data.name);(u||i==="init")&&(u||(u=new o(f)),u[i]&&u[i].apply(u,r))}),this},n.fn.scrollbar.options=r,i=function(){var n=0,r=0;return function(u){for(var o,c,f,e,l,a,h=0;h<t.scrolls.length;h++)f=t.scrolls[h],o=f.container,c=f.options,e=f.wrapper,l=f.scrollx,a=f.scrolly,(u||c.autoUpdate&&e&&e.is(":visible")&&(o.prop("scrollWidth")!=l.size||o.prop("scrollHeight")!=a.size||e.width()!=l.visible||e.height()!=a.visible))&&(f.init(),c.debug&&(window.console&&console.log({scrollHeight:o.prop("scrollHeight")+":"+f.scrolly.size,scrollWidth:o.prop("scrollWidth")+":"+f.scrollx.size,visibleHeight:e.height()+":"+f.scrolly.visible,visibleWidth:e.width()+":"+f.scrollx.visible},!0),r++));s&&r>10?(window.console&&console.log("Scroll updates exceed 10"),i=function(){}):(clearTimeout(n),n=setTimeout(i,300))}}(),window.angular&&function(n){n.module("jQueryScrollbar",[]).provider("jQueryScrollbar",function(){var t=r;return{setOptions:function(i){n.extend(t,i)},$get:function(){return{options:n.copy(t)}}}}).directive("jqueryScrollbar",["jQueryScrollbar","$parse",function(n,t){return{restrict:"AC",link:function(i,r,u){var f=t(u.jqueryScrollbar),e=f(i);r.scrollbar(e||n.options).on("$destroy",function(){r.scrollbar("destroy")})}}}])}(window.angular)}),function(n){function t(n,t){var i="scrolled-from-bottom";n.attr(i,t)}function i(n){var r=n.height(),u=n.scrollTop()+r,f=40,e=n.prop("scrollHeight"),i=e-f>u?1:0;return t(n,i),i==1}n.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.height()},n.fn.movedScrollFromBottom=function(){return i(this)},n.fn.setScroller=function(n){var r=this,t=function(){i(r)?n.onChange&&n.onChange():n.onBottom&&n.onBottom()},u=n.ignoreScrollEvent?!1:"scroll";r.bind("scroll mousedown wheel DOMMouseScroll mousewheel",function(n){(n.which>0||n.type=="mousedown"||n.type==u||n.type=="mousewheel")&&t()}),n.initMouseUpElement&&(n.initMouseUpElement.mouseup(function(){t()}),n.initMouseUpElement.bind("scroll mousedown wheel DOMMouseScroll mousewheel",function(n){(n.which>0||n.type=="mousedown"||n.type==u||n.type=="mousewheel")&&t()}))},n.fn.scrollToBottom=function(i){var r=this.get(0);i?r.scrollTop+=i:(r.scrollTop=r.scrollHeight,t(n("#"+r.id),0))}}(jQuery),TimerWidget.prototype.Start=function(){try{TimerWidget.PaidSessionTimer==undefined&&(TimerWidget.prototype.StartTime=new Date,TimerWidget.PaidSessionTimer=setInterval(TimerWidget.prototype.onTimerPaidSession,100),TimerWidget.prototype.IsStaticMode&&TimerWidget.PaidSessionTimerControl.text(TimerWidget.prototype.StartTime.format("HH:MM")))}catch(n){TimerWidget.ErrorCallback(n)}},TimerWidget.prototype.Stop=function(){try{TimerWidget.prototype.EndTime=new Date,clearInterval(TimerWidget.PaidSessionTimer)}catch(n){TimerWidget.ErrorCallback(n)}},TimerWidget.prototype.Pause=function(){TimerWidget.prototype.IsPaused=!0},TimerWidget.prototype.Resume=function(){TimerWidget.prototype.IsPaused=!1},TimerWidget.prototype.GetDurationInSeconds=function(){var t=0,n;return TimerWidget.prototype.StartTime!==null&&TimerWidget.prototype.EndTime!==null&&(n=TimerWidget.prototype.EndTime-TimerWidget.prototype.StartTime,t=n/1e3),t},TimerWidget.prototype.EndTime=null,TimerWidget.prototype.StartTime=null,TimerWidget.prototype.PreviousTime=null,TimerWidget.prototype.LastUpdatedTime=null,TimerWidget.prototype.ElapsedTime=0,TimerWidget.prototype.onTimerPaidSession=function(){var n,f,i,r,u,t;try{if(TimerWidget.prototype.IsPaused||TimerWidget.prototype.PreviousTime||(TimerWidget.prototype.PreviousTime=Date.now()),TimerWidget.prototype.ElapsedTime+=Date.now()-TimerWidget.prototype.PreviousTime,TimerWidget.prototype.PreviousTime=Date.now(),n=TimerWidget.prototype.ElapsedTime,f=n%1e3,n=Math.floor(n/1e3),i=n%60,n=Math.floor(n/60),r=n%60,n=Math.floor(n/60),u=n%60,TimerWidget.seconds=Number(i),TimerWidget.minutes=Number(r),TimerWidget.hours=Number(u),TimerWidget.prototype.IsStaticMode)return;t="",(TimerWidget.hours>0||!TimerWidget.HideHours)&&(t+=TimerWidget.prototype.FormatNumberLength(TimerWidget.hours,2)+":"),t+=TimerWidget.prototype.FormatNumberLength(TimerWidget.minutes,2)+":"+TimerWidget.prototype.FormatNumberLength(TimerWidget.seconds,2),t!==TimerWidget.prototype.LastUpdatedTime&&(TimerWidget.prototype.LastUpdatedTime=t,TimerWidget.PaidSessionTimerControl.text(t))}catch(e){TimerWidget.ErrorCallback(e)}},TimerWidget.prototype.GetCurrentTime=function(){try{return TimerWidget.hours+":"+TimerWidget.minutes+":"+TimerWidget.seconds}catch(n){return TimerWidget.ErrorCallback(n),"0"}},TimerWidget.prototype.FormatNumberLength=function(n,t){for(var i=""+n;i.length<t;)i="0"+i;return i},TextType={NULL_TEXT:0,EMPTY_TEXT:1,TEXT_LINE:2,REGULAR_CHAR:3,BACKSPACE_CHAR:8,NEW_LINE_CHAR:10,SPACE_CHAR:32},function(){function t(n,t){var i;for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function n(n){var t,i;if(n==null)t=TextType.NULL_TEXT;else if(n.length<=0)t=TextType.EMPTY_TEXT;else if(n.length==1){i=n.charCodeAt(0);switch(i){case TextType.BACKSPACE_CHAR:case TextType.NEW_LINE_CHAR:case TextType.SPACE_CHAR:t=i;break;default:t=TextType.REGULAR_CHAR}}else t=TextType.TEXT_LINE;this.data=n,this.textType=t}function i(){TextProcessor.prototype.IsBrowserFocused=!1}function r(){TextProcessor.prototype.IsBrowserFocused=!0}this.TextProcessor=function(){this.Interval="",this.IsIntervalRunning=!1,this.IsProcessingText=!1,this.TextQueue=[],this.FirstMessageLength=0;var n=50,i={trace:!1,intervalTime:n,startImmediately:!1,doneTextCallback:function(){},processTextCallback:function(){},charByChar:!1,useInterval:!0,preProcessingCallback:function(){}};arguments[0]&&typeof arguments[0]=="object"&&(this.options=t(i,arguments[0])),this.options.intervalTime<n&&(this.options.intervalTime=n),this.options.startImmediately&&(this.Run(),this.Trace("Started Immediately"))},TextProcessor.prototype.Trace=function(n,t){this.options.trace&&(console.info("Trace TextProcessor: "+n),t&&console.info(JSON.stringify(t)))},TextProcessor.prototype.Run=function(){var r=0,i="",u=!1,t;this.IsIntervalRunning=!0,t=this,this.Interval=setInterval(function(){var f,e,o;if(t.options.preProcessingCallback&&t.options.preProcessingCallback(),t.IsProcessingText||t.TextQueue.length>0&&(t.IsProcessingText=!0,i=t.TextQueue.shift()),t.IsProcessingText&&(u=i==null,t.options.charByChar?(f=new n(u?null:i[r]),t.Trace("Processing text",f),t.options.processTextCallback(f)):f=new n(i),r++,u||r>=i.length))if(u=!1,r=0,i="",t.IsProcessingText=!1,t.options.charByChar)t.Trace("Reached end of text"),t.options.doneTextCallback();else{if(t.Trace("Single processing of text"),f.data.length===0)t.options.processTextCallback(new n(f.data[e]));else for(e=0,o=f.data.length;e<o;e++)t.options.processTextCallback(new n(f.data[e]));t.options.doneTextCallback()}},t.options.intervalTime)},TextProcessor.prototype.CreateTextObj=function(t){return new n(t)},TextProcessor.prototype.AddText=function(n){var t=this;t.options.charByChar&&t.options.useInterval?t.ProcessTextInterval(n):t.ProcessTextImmediate(n)},TextProcessor.prototype.ProcessTextInterval=function(n){var t=this;t.IsIntervalRunning||t.Run(),t.TextQueue.push(n),t.Trace("Pushed to queue = "+n)},TextProcessor.prototype.ProcessTextImmediate=function(t){var r=this,u=new n(t),i,f;if(r.Trace("Single processing of text (immediate)"),u.data.length===0)r.options.processTextCallback(new n(u.data[i]));else for(i=0,f=u.data.length;i<f;i++)r.options.processTextCallback(new n(u.data[i]));r.options.doneTextCallback()},window.onfocus=r,window.onblur=i}(),ExpertStatusServiceModule=function(){function t(t){var i=n.serviceUrl+"/{0}";return String.format(i,t)}function r(i,r,u,f){n.method=="GET"?$.ajax({type:n.method,url:t(i)+"/"+r,dataType:"json",contentType:"application/json; charset=utf-8",success:u,error:f}):n.method=="POST"&&$.ajax({type:n.method,url:t(i),data:JSON.stringify(r),dataType:"json",contentType:"application/json; charset=utf-8",success:u,error:f})}var n={},i={EXPERTS_STATUSES:"ExpertsStatuses"};return n.serviceUrl="",n.method="POST",n.isExpertAvailableForChat=function(n,t,u){r(i.EXPERTS_STATUSES,n,function(n){var r=!1,i;n.length>0&&(i=n[0].ST,r=i==1||i==4),t(r)},u)},n}(),function(n){"use strict";function r(n){var i=t.serviceHost+t.serviceUrl+n;return i.indexOf("http")===-1&&(i="https://"+i),i}function i(n,i,u,f){if(t.inProgress[n])return null;t.inProgress[n]=!0;var e=r(n);$.ajax({type:"POST",url:e,data:i,dataType:"json",xhrFields:{withCredentials:!0},xhr:function(){var n=new window.XMLHttpRequest;return n.upload.addEventListener("progress",function(n){if(n.lengthComputable){var t=n.loaded/n.total;u&&u.inProgress&&u.inProgress(t)}},!1),n.addEventListener("progress",function(n){if(n.lengthComputable){var t=n.loaded/n.total;u&&u.inProgress&&u.inProgress(t)}},!1),n},beforeSend:function(){u&&u.beforeSend&&u.beforeSend()},success:function(i){var r=f?f(i.status):"";i&&(i.errorMessage=r),u&&u.success&&u.success(i),setTimeout(function(){t.inProgress[n]=!1},2e3)},complete:function(){u&&u.complete&&u.complete()},error:function(i){u&&u.error&&u.error(i),setTimeout(function(){t.inProgress[n]=!1},2e3)}})}function u(n){t.serviceHost=n;var r=function(n){var t={Failed:1,InvalidModel:2,MemberDoesntExist:3,InvalidPhoneNumber:4},i="";switch(parseInt(n)){case t.Failed:i="Something went wrong. Please try again later.";break;case t.InvalidModel:case t.MemberDoesntExist:i="Request is invalid. Please try again later.";break;case t.InvalidPhoneNumber:i="Phone number is not valid. Please try again."}return i};this.createSendMessageRequestObj=function(n,t){return{toDestinationID:n,content:t}},this.createUpdateSubscriptionRequestObj=function(n,t,i){return{setToEnable:n,phoneNumberVm:{countryCode:t,phone:i}}},this.sendMessage=function(n,r){var u=function(n){var t={Failed:1,InvalidModel:2,InvalidMessage:3,MemberDoesntExist:4,ExpertDoesntExist:5,MemberDidntConsultWithExpert:6,ConversationBlocked:7},i="";switch(parseInt(n)){case t.Failed:i="Something went wrong. Please try again later.";break;case t.InvalidModel:case t.InvalidMessage:i="Message is invalid. Please try again.";break;case t.MemberDoesntExist:i="We can't find this member. Please try again later.";break;case t.ExpertDoesntExist:i="We canâ€™t find this expert. Please try again later.";break;case t.MemberDidntConsultWithExpert:i="You can only message an expert after a session with him.";break;case t.ConversationBlocked:i="New message cannot be sent at this time."}return i};i(t.serviceMethod.SEND_MESSAGE,n,r,u)},this.isSubscribedToSmsNotification=function(n){i(t.serviceMethod.IS_SUBSCRIBED,{},n,r)},this.updateSmsNotficationSubscription=function(n,u){i(t.serviceMethod.UPDATE_SUBSCRIPTION,n,u,r)},this.countUnreadInboxConversations=function(n){i(t.serviceMethod.COUNT_UNREAD_INBOX,{},n,r)}}var t={serviceHost:"",serviceUrl:"/Member/InstantMessages/",serviceMethod:{SEND_MESSAGE:"SendMessage",IS_SUBSCRIBED:"IsSubscribedToSmsNotification",UPDATE_SUBSCRIPTION:"UpdateSmsNotficationSubscription",COUNT_UNREAD_INBOX:"CountUnreadInboxConversations"},inProgress:{}};n.InstantMessagesService=u}(LP.services=LP.services||{}),function(n){"use strict";function r(n){var i=t.serviceHost+t.serviceUrl+n;return i.indexOf("http")===-1&&(i="https://"+i),i}function i(n,i,u,f){var e=i.newEventName,o;return(e||(e=n),t.inProgress[e])?null:(t.inProgress[e]=!0,o=r(n),$.ajax({type:"POST",url:o,data:JSON.stringify(i),dataType:"json",contentType:"application/json; charset=utf-8",xhrFields:{withCredentials:!0},success:function(n){var i=f?f(n):"";n&&(n.errorMessage=i),u&&u.success&&u.success(n),setTimeout(function(){t.inProgress[e]=!1},2e3)},error:function(n){u&&u.error&&u.error(n),setTimeout(function(){t.inProgress[e]=!1},2e3)}}))}function u(n){n&&(t.serviceHost=n);var r=function(n){var i={Success:0,Failed:1,InvalidModel:2},u=n.status,t="",r;switch(parseInt(u)){case i.InvalidModel:case i.Success:if(n.errors!==null&&n.errors.viewModelRequest!==null){t="The request is invalid: ";for(r in n.errors.viewModelRequest)t=t.concat(r+"\n");console.log("Tracking events: "+t)}break;case i.Failed:t="Something went wrong. Please try again later."}return t};this.createTrackingRequestObj=function(n,t,i){return{newEventName:t,newEventType:n,newEventData:i}},this.trackEvent=function(n,u){return i(t.serviceMethod.ADD_NEW_EVENT,n,u,r)},this.trackEventByName=function(n,t,i,r){return this.trackEvent(this.createTrackingRequestObj(n,t,i),r)},this.trackEvents=function(n,u){return i(t.serviceMethod.ADD_NEW_EVENTS,{events:n},u,r)}}var t={serviceHost:"api.kasamba.com",serviceUrl:"/Member/Tracking/",serviceMethod:{ADD_NEW_EVENT:"AddNewEvent",ADD_NEW_EVENTS:"AddNewEvents"},inProgress:{}};n.TrackingEventsService=u}(LP.services=LP.services||{}),function(n){"use strict";function i(n){n&&(t.accountDomain=n.accountDomain||t.accountDomain,t.apiKey=n.apiKey||t.apiKey,t.productId=n.productId||t.productId,t.groupId=n.groupId||t.groupId)}function r(n){return"https://"+t.accountDomain+".freshdesk.com/api/v"+t.apiVersion+"/"+(n||"")}function u(){return{Authorization:"Basic "+btoa(t.apiKey+":X")}}var t={apiVersion:2,accountDomain:"",apiKey:"",productId:null,groupId:null};i.prototype.createTicket=function(n){var i=$.extend({phone:"",email:null,requester_id:null,twitter_id:null,facebook_id:null,product_id:t.productId,group_id:t.groupId,name:"",description:"",subject:"",priority:1,source:2,status:2,cc_emails:[],tags:[],custom_fields:{}},n);return $.ajax({url:r("tickets.json"),crossDomain:!0,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",headers:u(),data:JSON.stringify(i),success:function(n){n&&console.log("Ticket #"+n.id+" created successfuly")},error:function(n){console.log("Failed creating a new ticket"),console.log(n.status)}})},i.prototype.getTicket=function(n){return $.ajax({url:r("tickets/"+n),type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",headers:u(),success:function(t){t&&(console.log("Ticket #"+n+"retrieved"),console.log(t))},error:function(t){console.log("Could not retrieve ticket #"+n),console.log(t.status)}})},i.prototype.getProduct=function(n){return $.ajax({url:r("products/"+n),type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",headers:u(),success:function(t){t&&(console.log("Product #"+n+"retrieved"),console.log(t))},error:function(t){console.log("Could not retrieve product #"+n),console.log(t.status)}})},i.prototype.getProducts=function(){return $.ajax({url:r("products"),type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",headers:u(),success:function(n){n&&(console.log("Products retrieved"),console.log(n))},error:function(n){console.log("Could not retrieve products"),console.log(n.status)}})},n.FreshdeskService=i}(LP.services=LP.services||{}),function(n){"use strict";function i(n){var i=t.serviceHost+t.serviceUrl+n;return i.indexOf("http")===-1&&(i="https://"+i),i}function r(){this.getMemberSingleSessionData=function(n,i){return u(t.serviceMethod.getMemberSingleSessionData,{sessionId:n},i)}}function u(n,t,r){var u=i(n);return $.ajax({type:"GET",url:u,data:t,dataType:"json",contentType:"application/json; charset=utf-8",xhrFields:{withCredentials:!0},success:function(n){r&&r(n)},error:function(n){console.error(JSON.stringify(n))}})}var t={serviceHost:"api.kasamba.com/",serviceUrl:"Session/Session/",serviceMethod:{getMemberSingleSessionData:"GetMemberSingleSessionData"}};n.SessionService=r}(LP.services=LP.services||{}),function(n){"use strict";function i(n){var i=t.serviceHost+t.serviceUrl+n;return i.indexOf("http")==-1&&(i="https://"+i),i}function r(n,r,u,f){if(t.inProgress[n])return null;t.inProgress[n]=!0;var e=i(n);$.ajax({type:"POST",url:e,data:r,dataType:"json",xhrFields:{withCredentials:!0},xhr:function(){var n=new window.XMLHttpRequest;return n.upload.addEventListener("progress",function(n){if(n.lengthComputable){var t=n.loaded/n.total;u.inProgress&&u.inProgress(t)}},!1),n.addEventListener("progress",function(n){if(n.lengthComputable){var t=n.loaded/n.total;u.inProgress&&u.inProgress(t)}},!1),n},beforeSend:function(){u.beforeSend&&u.beforeSend()},success:function(i){var r=f?f():"";i&&(i.errorMessage=r),u.success&&u.success(i),setTimeout(function(){t.inProgress[n]=!1},2e3)},complete:function(){u.complete&&u.complete()},error:function(i){console.error(JSON.stringify(i)),u.error&&u.error(i),setTimeout(function(){t.inProgress[n]=!1},2e3)}})}function u(n,t,r){var u=i(n);return $.ajax({type:"POST",url:u,data:JSON.stringify(t),dataType:"json",contentType:"application/json; charset=utf-8",xhrFields:{withCredentials:!0},success:function(n){r&&r(n)},error:function(n){console.error(JSON.stringify(n))}})}function f(n){n&&(t.serviceHost=n),this.createGetMainPhoneNumberRequestObj=function(){return{}},this.getMemberAdditionalDetails=function(){return u(t.serviceMethod.GET_MEMBER_ADDITIONAL_DETAILS,{})},this.getMainPhoneNumber=function(n,i){var u=function(n){var i={Failed:1,MemberDoesntExist:2,MainPhoneNumberDoesntExist:3,InvalidModel:4},t="";switch(parseInt(n)){case i.Failed:t="Something went wrong. Please try again later.";break;case i.InvalidModel:t="Message is invalid. Please try again.";break;case i.MemberDoesntExist:t="We can't find this member. Please try again later.";break;case i.MainPhoneNumberDoesntExist:t=""}return t};r(t.serviceMethod.GET_MAIN_PHONE_NUMBER,n,i,u)}}var t={serviceHost:"api.kasamba.com",serviceUrl:"/Member/Members/",serviceMethod:{GET_MAIN_PHONE_NUMBER:"GetMainPhoneNumber",GET_MEMBER_ADDITIONAL_DETAILS:"GetMemberAdditionalDetails"},inProgress:{}};n.MembersService=f}(LP.services=LP.services||{}),ChatType={BeforeChat:"BeforeChat",BeforeMobileChat:"BeforeMobileChat",BeforeMobileNativeChat:"BeforeMobileNativeChat",Flash:"FlashChat",Html5:"Html5Chat",Mobile:"MobileChat",Desktop:"DesktopChat",MobileNative:"MobileNativeChat",Undefined:"UndefinedChat"},LogLevel={NONE:0,INFO:2,WARNING:3,ERROR:4};var ChatLogEvents={generalErrorEvent:new LogEvent(LogLevel.ERROR,"General Error"),generalEvent:new LogEvent(LogLevel.WARNING,"General Event"),landscapeDisabled:new LogEvent(LogLevel.INFO,"Landscape Disabled"),landscapeDismissed:new LogEvent(LogLevel.WARNING,"Landscape was Cancelled"),fsErrorEvent:new LogEvent(LogLevel.ERROR,"FlashSocket Error"),wsErrorEvent:new LogEvent(LogLevel.ERROR,"WebSocket Error"),wsGeneralEvent:new LogEvent(LogLevel.WARNING,"WebSocket Event"),twErrorEvent:new LogEvent(LogLevel.ERROR,"Timer Widget Error"),startSessionButtonClicked:new LogEvent(LogLevel.INFO,"Start Session Button Clicked"),checkFlashVersion:new LogEvent(LogLevel.INFO,"Check Flash Version"),userCameFromTouch:new LogEvent(LogLevel.INFO,"User from Touch starting a chat on the web"),transactionError:new LogEvent(LogLevel.WARNING,"Transaction Error"),sessionVerificationError:new LogEvent(LogLevel.ERROR,"Session verification failed"),cantCallYourself:new LogEvent(LogLevel.WARNING,"KM_CANT_CALL_YOURSELF (1102)"),connectionError:new LogEvent(LogLevel.ERROR,"Connection Error"),connectionSlow:new LogEvent(LogLevel.WARNING,"Connection Slow"),connectionReconnecting:new LogEvent(LogLevel.WARNING,"Connection Reconnecting"),connectionReconnected:new LogEvent(LogLevel.WARNING,"Connection Reconnected"),chatOpenError:new LogEvent(LogLevel.WARNING,"Chat Open Error"),flashLoaded:new LogEvent(LogLevel.INFO,"Flash Loaded"),flashNoWebSockets:new LogEvent(LogLevel.WARNING,"Flash - no websockets"),chatPageLoaded:new LogEvent(LogLevel.INFO,"Chat Page Loaded"),hireConfirmed:new LogEvent(LogLevel.INFO,"KM_HIRE_CONFIRMED (2048)"),hireDenied:new LogEvent(LogLevel.INFO,"KM_HIRE_DENIED (2049)"),autoHire:new LogEvent(LogLevel.INFO,"Auto Hire"),expertAgreeToConsult:new LogEvent(LogLevel.INFO,"KM_EXPERT_AGREE_TO_CONSULT (2027)"),sessionClosed:new LogEvent(LogLevel.WARNING,"KM_SESSION_CLOSED (2028)"),expertClosedSession:new LogEvent(LogLevel.WARNING,"KM_CLOSE_SESSION (1078)"),serverIsClosing:new LogEvent(LogLevel.ERROR,"KM_TRY_LATER_BECAUSE_SERVER_IS_CLOSING (2034)"),expertBusy:new LogEvent(LogLevel.WARNING,"KM_EXPERT_BUSY (2030)"),expertUnavailable:new LogEvent(LogLevel.INFO,"Expert is Unavailable"),simulateExpertResponse:new LogEvent(LogLevel.WARNING,"KM_SIMULATE_EXPERT_RESPONSE (2036)"),expertNotAgreeToConsult:new LogEvent(LogLevel.WARNING,"KM_EXPERT_NOT_AGREE_TO_CONSULT (2026)"),loginFailed:new LogEvent(LogLevel.WARNING,"KM_LOGIN_FAILED (1228)"),socketNotFound:new LogEvent(LogLevel.ERROR,"KM_SOCKET_NOT_FOUND (2031)"),memberManualClose:new LogEvent(LogLevel.INFO,"Member Manual Close"),connectionStartSuccess:new LogEvent(LogLevel.INFO,"Connection Start Success"),connectionStartFailure:new LogEvent(LogLevel.INFO,"Connection Start Failure"),VALUES:{QuitReason:{DialogShown:"Close Browser Dialog shown",TabOrBrowser:"TAB_OR_BROWSER_QUIT",QuitButton:"QUIT_BUTTON",OnWaitingForExpert:"WAITING_FOR_EXPERT",Lightbox:"FLASH_LIGHTBOX",SwitchToHtml:"SWITCH_TO_HTML",SwitchToFlash:"SWITCH_TO_FLASH"}}},ChatLog=function(){return{chatType:"",data:{expertId:0,memberId:0,categoryId:0,sessionId:0,flashVersion:0},status:"pageLoad",log:function(n,t,i){typeof t=="undefined"?t="":"",i=typeof i=="undefined"?!0:i;var r={},u=this.data;this.data&&(r=u),r.area="chat",r.chatType=this.chatType?this.chatType:ChatType.Undefined,r.chatStatus=this.status,r.chatEvent=n&&n.message?n.message:"",t&&(r.chatEventMessage=t);switch(n.loggingLevel){case LogLevel.INFO:Logger.Info(r,i);break;case LogLevel.WARNING:Logger.Warning(r,i);break;case LogLevel.ERROR:Logger.Error(r,i),console.error(r);break;default:console.error("Can't log event = "+JSON.stringify(n))}}}}(),ChatManager={};ChatManager.data={},ChatManager.initUI=function(n){ChatUI.init(n,ChatManager.data)},ChatManager.init=function(n){SessionDetailsServiceModule.setServiceRoot(n.WebServiceRoot),this.data=n,this.data.ConsultAgree=!1,typeof ChatLog!="undefined"&&typeof ChatLog.data!="undefined"&&(ChatLog.data.expertId=n.ExpertID,ChatLog.data.memberId=n.MemberID,ChatLog.data.categoryId=n.CatID),new MainConnection(n.connectionData)},ChatManager.leaveMessageToExpertOnBusy=function(){try{if(typeof WebSettings=="undefined"||typeof LP=="undefined"||[3,5,6,7].indexOf(WebSettings.getApplication().siteId)==-1)return;var n=new LP.services.InstantMessagesService(WebSettings.CasApiEndpoint),t=n.createSendMessageRequestObj(ChatManager.data.ExpertID,"I tried to start a session with you but you were busy, please let me know when you are free to chat");n.sendMessage(t,{success:function(n){n.status===0},error:function(){}})}catch(i){}},ChatManager.sendError=function(n){MainConnection.prototype.SendError(n.message)},ChatManager.checkIfSafariNotInPrivateMode=function(){if(typeof sessionStorage!="undefined"){var n="__localstoragetest__";try{sessionStorage.setItem(n,n),sessionStorage.removeItem(n)}catch(t){return console.log("No storage for you!"),!1}return!0}return!1},ChatManager.tryStartChat=function(n){var t=5,f=45,i=f+15,r=function(){ChatManager.leaveMessageToExpertOnBusy(),ChatServerEvents.OnSessionClosed("10"),ChatLog.log(ChatLogEvents.expertBusy)},e=function(){setTimeout(function(){parseInt(ChatManager.data.SessionID)<=0&&$("#colorbox").css("display")!="block"&&(ChatServerEvents.OnSessionClosed("9"),ChatLog.log(ChatLogEvents.sessionVerificationError))},1e3*i)},u=function(){MainConnection.prototype.connect(),e()};n?u():(console.log("Expert was busy, retry in seconds: "+t),i+=t,setTimeout(function(){ExpertStatusServiceModule.isExpertAvailableForChat(ChatManager.data.ExpertID,function(n){console.log("Expert is "+(n?"":"not")+"available"),n?u():r()},function(){r()})},1e3*t))},ChatManager.sessionStorageKey="LastSessionDetails",ChatManager.setLastSessionDetail=function(n,t){if(sessionStorage&&ChatManager.checkIfSafariNotInPrivateMode()){var i=sessionStorage.getObj(ChatManager.sessionStorageKey);i=i||{},i[n]=t,sessionStorage.setObj(ChatManager.sessionStorageKey,i)}},Storage.prototype.setObj=function(n,t){return this.setItem(n,JSON.stringify(t))},Storage.prototype.getObj=function(n){return JSON.parse(this.getItem(n))},ChatManager.getEndReasonNameById=function(n){switch(n){case"1":return"CustomerQuit";case"2":return"CustomerDisconnected";case"3":return"CustomerAccountDepleted";case"4":return"ExpertQuit";case"5":return"ExpertDisconnected";case"6":return"KserverShutdown";case"9":return"TechnicalError";case"10":return"ExpertUnavailable";case"11":return"ClientBlocked";case"12":return"ConnectivityIssues";default:return"Unknown"}},Login.prototype.MsgCode={Login_OK:1227,Login_Failed:1228,Expert_Not_Agree_To_Consult:2026,Expert_Busy:2030,Socket_Not_Found:2031,Server_Is_ShuttingDown:2034,Expert_Unavilable:2036,System_Message:2041,Connect_Yourself:1102},Login.prototype.IsBAH=function(){return Login.BAH=="1"},Login.prototype.SendRequest=function(){try{MainConnection.prototype.SendMessage(Login.JsonMsg)}catch(n){MainConnection.prototype.SendError(n.message)}},Login.prototype.Process=function(n){try{var t=Number(n.MSG.MSGH.MSGID);switch(t){case Login.prototype.MsgCode.Login_OK:Login.prototype.HandleLogin(n);break;case Login.prototype.MsgCode.Server_Is_ShuttingDown:Session.prototype.ClosedSessionMessageSent=!0,ChatServerEvents.OnSessionClosed("6"),ChatLog.log(ChatLogEvents.serverIsClosing);break;case Login.prototype.MsgCode.Expert_Busy:Session.prototype.ClosedSessionMessageSent=!0,ChatManager.leaveMessageToExpertOnBusy(),ChatServerEvents.OnSessionClosed("10"),ChatLog.log(ChatLogEvents.expertBusy);break;case Login.prototype.MsgCode.Expert_Unavilable:Session.prototype.ClosedSessionMessageSent=!0,ChatServerEvents.OnSessionClosed("11"),ChatLog.log(ChatLogEvents.simulateExpertResponse);break;case Login.prototype.MsgCode.Expert_Not_Agree_To_Consult:Session.prototype.ClosedSessionMessageSent=!0,ChatServerEvents.OnSessionClosed("10"),ChatLog.log(ChatLogEvents.expertNotAgreeToConsult);break;case Login.prototype.MsgCode.Connect_Yourself:case Login.prototype.MsgCode.Login_Failed:case Login.prototype.MsgCode.Socket_Not_Found:Session.prototype.ClosedSessionMessageSent=!0,ChatServerEvents.OnSessionClosed("9"),t==Login.prototype.MsgCode.Login_Failed?ChatLog.log(ChatLogEvents.loginFailed):t==Login.prototype.MsgCode.Socket_Not_Found?ChatLog.log(ChatLogEvents.socketNotFound):t==Login.prototype.MsgCode.Connect_Yourself&&ChatLog.log(ChatLogEvents.cantCallYourself);break;case Login.prototype.MsgCode.System_Message:ChatServerEvents.OnFailedToStartChat(n.MSG.MSGDATA.TEXT);break;default:MainConnection.prototype.SendError("Login Method not implemented: "+n.MSG.MSGH.MSGID)}}catch(i){MainConnection.prototype.SendError(i.message)}},Login.prototype.HandleLogin=function(n){try{Session.FreeMinutes=n.MSG.MSGDATA.Params.FlashParams.fmValue?n.MSG.MSGDATA.Params.FlashParams.fmValue:n.MSG.MSGDATA.Params.FlashParams.clusterFreeMinutes?n.MSG.MSGDATA.Params.FlashParams.clusterFreeMinutes:-1,n.MSG.MSGDATA.Params.FlashParams.IsBillingAfterHire&&(Login.BAH=n.MSG.MSGDATA.Params.FlashParams.IsBillingAfterHire),ChatServerEvents.OnLoginOK(n.MSG.MSGDATA.Params.FlashParams.ExpName,n.MSG.MSGDATA.Params.FlashParams.HasPIC,n.MSG.MSGDATA.Params.FlashParams.ExpertID,n.MSG.MSGDATA.Params.FlashParams.ClientID,n.MSG.MSGDATA.Params.FlashParams.CatID,Login.JsonMsg.MSG.DATA.GUID),Session.JsonChatMsg.MSG.HEADER.source=n.MSG.MSGDATA.Params.FlashParams.ClientID,Session.JsonStartTypingMsg.MSG.HEADER.source=n.MSG.MSGDATA.Params.FlashParams.ClientID,Session.JsonCanceledTypingMsg.MSG.HEADER.source=n.MSG.MSGDATA.Params.FlashParams.ClientID}catch(t){MainConnection.prototype.SendError(t.message)}},Session.prototype.MsgCode={Chat_Text_Line:1084,Expert_Fee:1085,Hire_Confirmed:2048,Hire_denied:2049,BAH_Show_CC_Form:2073,Session_Closed:2028,Expert_Close_Session:1078,Expert_Agree_To_Consult:2027,Try_Later_Server_Closing:2034,CLOSING_SERVER:1093},Session.prototype.MemberTextLength=0,Session.prototype.ClosedSessionMessageSent=!1,Session.prototype.SendMessageDirect=function(n){try{Session.JsonChatMsg.MSG.DATA.TEXT+=n,Session.prototype.SendMessageAndClearBuffer()}catch(t){MainConnection.prototype.SendError(t.message)}},Session.prototype.onTimerSendText=function(){try{Session.prototype.SendMessageAndClearBuffer()}catch(n){MainConnection.prototype.SendError(n.message)}},Session.prototype.SendMessageAndClearBuffer=function(){Session.JsonChatMsg.MSG.DATA.TEXT!=""&&MainConnection.prototype.SendMessage(Session.JsonChatMsg)&&(Session.JsonChatMsg.MSG.DATA.TEXT="")},Session.prototype.SendClientStartTyping=function(){MainConnection.prototype.SendMessage(Session.JsonStartTypingMsg)},Session.prototype.SetDisconnectionCallback=function(n){MainConnection.prototype.RunActionOnDisconnected(n)},Session.prototype.SendClientCanceledTyping=function(){MainConnection.prototype.SendMessage(Session.JsonCanceledTypingMsg)},Session.prototype.BillingInfoWasVerified=function(n){try{Session.JsonBillingInfoWasVerifiedMsg.MSG.DATA.transactionID=n,MainConnection.prototype.SendMessage(Session.JsonBillingInfoWasVerifiedMsg)}catch(t){MainConnection.prototype.SendError(t.message)}},Session.prototype.FailedFillingBillingInfo=function(){try{MainConnection.prototype.SendMessage(JsonFailedFillingBillingInfoMsg)}catch(n){MainConnection.prototype.SendError(n.message)}},Session.prototype.LastMsg="",Session.prototype.Closed=!1,Session.prototype.Process=function(n){try{switch(Number(n.MSG.MSGH.MSGID)){case Session.prototype.MsgCode.Chat_Text_Line:var t=n.MSG.MSGH.SOURCE=="1"?!0:null;ChatServerEvents.OnExpertMessage(n.MSG.MSGDATA.TEXT,t),n.MSG.MSGDATA.AUTO_HIRE_EXPERT=="1"&&(console.log("AUTO_HIRE_EXPERT: hireEvent"),Session.prototype.hireEvent("AUTO_HIRE_EXPERT"));break;case Session.prototype.MsgCode.Expert_Fee:ChatServerEvents.OnFeeChanged(n.MSG.MSGDATA.TEXT);break;case Session.prototype.MsgCode.Hire_Confirmed:ChatServerEvents.OnHire(),ChatLog.log(ChatLogEvents.hireConfirmed);break;case Session.prototype.MsgCode.Hire_denied:ChatLog.log(ChatLogEvents.hireDenied),ChatServerEvents.Alert(n.MSG.MSGDATA.TEXT);break;case Session.prototype.MsgCode.BAH_Show_CC_Form:ChatServerEvents.Alert("You cannot hire this expert because there is no payment method available. You have to quit the session and make a deposit into your account first.");break;case Session.prototype.MsgCode.Session_Closed:MainConnection.prototype.CloseConnection(),clearInterval(Session.SendTextTimer),Session.prototype.ClosedSessionMessageSent=!0,ChatServerEvents.OnSessionClosed(n.MSG.MSGDATA.CLOSURE_REASON),ChatLog.log(ChatLogEvents.sessionClosed,"Reason Id: "+n.MSG.MSGDATA.CLOSURE_REASON);break;case Session.prototype.MsgCode.Expert_Close_Session:MainConnection.prototype.CloseConnection(),clearInterval(Session.SendTextTimer),Session.prototype.ClosedSessionMessageSent=!0,ChatServerEvents.OnSessionClosed("4"),ChatLog.log(ChatLogEvents.expertClosedSession);break;case Session.prototype.MsgCode.Expert_Agree_To_Consult:Session.SendTextTimer=setInterval(Session.prototype.onTimerSendText,3e3),Session.prototype.ProcessFreeMinutes(Session.FreeMinutes),ChatServerEvents.OnExpertAgreeToConsult(n.MSG.MSGH.DEST),ChatServerEvents.OnAgreeToConsult(n.MSG.MSGH.DEST,Session.FreeMinutes);break;case Session.prototype.MsgCode.Try_Later_Server_Closing:Session.prototype.ClosedSessionMessageSent=!0,ChatServerEvents.OnSessionClosed("6"),MainConnection.prototype.CloseConnection(),ChatServerEvents.OnServerClosingTryLater(),clearInterval(Session.SendTextTimer);break;case Session.prototype.MsgCode.CLOSING_SERVER:Session.prototype.ClosedSessionMessageSent=!0,ChatServerEvents.OnSessionClosed("6"),MainConnection.prototype.CloseConnection(),ChatServerEvents.OnServerClosingTryLater(),clearInterval(Session.SendTextTimer),ChatLog.log(ChatLogEvents.serverIsClosing);break;default:MainConnection.prototype.SendError("Session Method not implemented: "+n.MSG.MSGH.MSGID)}}catch(i){MainConnection.prototype.SendError(i.message)}},Session.prototype.onClientMessageChar=function(n){try{n!=null&&(Session.JsonChatMsg.MSG.DATA.TEXT+=n)}catch(t){MainConnection.prototype.SendError(t.message)}},Session.prototype.onClientMessage=function(n){var i=n.length,t=i-Session.prototype.MemberTextLength;t>0&&(Session.JsonChatMsg.MSG.DATA.TEXT+=n.substring(i,Session.prototype.MemberTextLength)),Session.prototype.MemberTextLength=Session.prototype.MemberTextLength+t<0?0:Session.prototype.MemberTextLength+t},Session.prototype.CheckBackSpace=function(n){var t=n.keyCode?n.keyCode:n.which;return t==8?(Session.JsonChatMsg.MSG.DATA.TEXT+="\b",!0):!1},Session.prototype.InsertBackSpace=function(){Session.JsonChatMsg.MSG.DATA.TEXT+="\b"},Session.prototype.hire=function(){var n=!1;try{typeof ChatConfig!="undefined"&&typeof ChatConfig.IsBAH!="undefined"&&(n=!ChatConfig.IsBAH)}catch(t){MainConnection.prototype.SendError(t.message)}try{return Login.prototype.IsBAH()&&!n?(MainConnection.IsBAH?(ChatServerEvents.OnStartBAHProcces(),MainConnection.prototype.SendMessage(Session.JsonOnloadBillingFormMsg)):ChatServerEvents.Alert("You cannot hire this expert because there is no payment method available. You have to quit the session and make a deposit into your account first."),!1):(clearTimeout(Session.FreeMinutesTimeout),MainConnection.prototype.SendMessage(Session.JsonHireMsg),!0)}catch(t){MainConnection.prototype.SendError(t.message)}return!1},Session.prototype.hireEvent=function(n){Session.prototype.hire(),ChatLog.log(ChatLogEvents.autoHire,n)},Session.prototype.DEBUG=!1,Session.prototype.sendQuitSessionRequest=function(n){ChatLog.log(ChatLogEvents.memberManualClose,n,!1);try{MainConnection.prototype.SendMessage(Session.JsonQuitMsg),ChatServerEvents.OnQuitSessionRequest(),clearInterval(Session.SendTextTimer)}catch(t){MainConnection.prototype.SendError(t.message)}},Session.prototype.quitSessionAndCloseConnection=function(n){ChatLog.log(ChatLogEvents.memberManualClose,n,!1);try{MainConnection.prototype.CloseConnection(),ChatServerEvents.OnQuitSessionRequest(),clearInterval(Session.SendTextTimer)}catch(t){MainConnection.prototype.SendError(t.message)}},Session.prototype.ProcessFreeMinutes=function(n){try{if(n>0&&(Session.FreeMinutesTimeout=setTimeout(function(){console.log("FreeMinutesTimeout: hireEvent"),Session.prototype.hireEvent("FreeMinutesTimeout")},n*6e4),ChatServerEvents.OnStartChatHasFreeMinutes()),n<0)return;n==0}catch(t){MainConnection.prototype.SendError(t.message)}},Session.prototype.Upload=function(n){try{$.ajax({url:"/WebServices/ajax/OnlineChatImageAttachment.svc/SendFile",type:"POST",dataType:"image/jpeg",data:n})}catch(t){MainConnection.prototype.SendError(t.message)}},MainConnection.prototype.getReadyState=function(){var n="";if(MainConnection.ws)switch(MainConnection.ws.readyState){case 0:n="CONNECTING";break;case 1:n="OPEN";break;case 2:n="CLOSING";break;case 3:n="CLOSED"}return n},MainConnection.prototype.connect=function(){try{if(typeof MozWebSocket!="undefined")MainConnection.ws=new MozWebSocket(MainConnection.ServerAddress);else if(window.WebSocket)MainConnection.ws=new WebSocket(MainConnection.ServerAddress);else{ChatLog.log(ChatLogEvents.wsErrorEvent,"Websocket is not supported in this browser"),ChatServerEvents.Alert("ERROR: This browser does not support WebSockets."),MainConnection.prototype.SendError("ERROR: This browser does not support WebSockets.");return}MainConnection.ws.onerror=function(n){ChatLog.log(ChatLogEvents.wsErrorEvent,"OnErrorEvent: "+JSON.stringify(n)+", ConnectionDetails = "+formatJsonData(MainConnection.prototype.GetConnectionDetails())),ChatClientEvents.CommunicationError()},MainConnection.ws.onopen=function(){MainConnection.OpLogin.SendRequest()},MainConnection.ws.onmessage=function(n){var t=JSON.parse(n.data);MainConnection.prototype.Trace("Message received = "+JSON.stringify(t));try{MainConnection.OperationsMap[t.MSG.MSGH.MSGID].Process(t)}catch(i){MainConnection.prototype.SendError("Unhandled Message "+t.MSG.MSGH.MSGID)}},MainConnection.ws.onclose=function(n){MainConnection.prototype.Trace("Connection is closed..."),Session.SendTextTimer&&clearInterval(Session.SendTextTimer),Session.prototype.ClosedSessionMessageSent||ChatClientEvents.CommunicationError(),ChatLog.log(ChatLogEvents.wsGeneralEvent,"OnCloseEvent: "+JSON.stringify(n))}}catch(n){MainConnection.prototype.SendError(n.message),ChatClientEvents.CommunicationError()}},MainConnection.prototype.GetConnectionDetails=function(){return{WebSocketState:MainConnection.prototype.getReadyState(),WebSocketBufferedAmount:MainConnection.ws.bufferedAmount,RecievedSessionClosed:Session.prototype.Closed}},MainConnection.prototype.CloseConnection=function(){Session.prototype.Closed=!0,setTimeout(function(){var t=MainConnection.prototype.GetConnectionDetails(),n="";if(Session.prototype.Closed&&MainConnection.ws)switch(MainConnection.ws.readyState){case MainConnection.ws.CONNECTING:n="Socket is connecting for some unexpected reason, connection closed by client.",MainConnection.ws.close();break;case MainConnection.ws.OPEN:n="Socket was open, connection closed by client.",MainConnection.ws.close();break;case MainConnection.ws.CLOSING:case MainConnection.ws.CLOSED:n="Socket is already closed or in closing state."}ChatLog.log(ChatLogEvents.wsGeneralEvent,n+" | ConnectionDetails = "+formatJsonData(t))},3e3)},MainConnection.prototype.SendMessage=function(n){var t,i;return MainConnection.ws!=null?(t=JSON.stringify(n),Session.prototype.LastMsg=t,MainConnection.ws.send(t),i=2,setTimeout(function(){if(MainConnection.ws.bufferedAmount==0)MainConnection.prototype.Trace("Message sent = "+t),Session.prototype.Closed&&(ChatLog.log(ChatLogEvents.wsErrorEvent,"Message sent while session already ended! | ConnectionDetails = "+formatJsonData(MainConnection.prototype.GetConnectionDetails())),MainConnection.prototype.CloseConnection());else{var n="Message unsent ("+i+" seconds)";MainConnection.prototype.Trace(n+" = "+t),ChatLog.log(ChatLogEvents.wsErrorEvent,n+" | ConnectionDetails = "+formatJsonData(MainConnection.prototype.GetConnectionDetails()))}},1e3*i),!0):!1},MainConnection.prototype.SendError=function(n){console.log(n),ChatLog.log(ChatLogEvents.generalErrorEvent,n)},MainConnection.prototype.Trace=function(n){MainConnection.ConsoleTrace=="True"&&console.log&&console.log(n)};var ChatPageModule=function(){var n={},t=function(){MainConnection.ws&&MainConnection.ws.close(3001,"BrowserClosedSocketOnUnload")},i=function(){return ChatLog.log(ChatLogEvents.memberManualClose,ChatLogEvents.VALUES.QuitReason.DialogShown),"Leaving this page will result in a session disconnection"};return n.bindUnloadEvents=function(){$(window).on("beforeunload",i);$(window).on("unload",t)},n.unbindUnloadEvents=function(){$(window).unbind("beforeunload",i),$(window).unbind("unload",t)},n.cleanText=function(n){return n=n.replace(/\\n/g,"\n"),n=n.replace(/\\'/g,"'")},n.trackEventChatStarted=function(){n.trackEvent(LP.enums.ChatAnalyticsEvents.ChatStart)},n.trackEvent=function(n){if(n)try{var t={event:n};this.trackEventByObject(t)}catch(i){console.log(n+" event failed ex: "+i)}},n.collectSuperProperties=function(){var n={},t;return(jQuery.extend(n,data),window.ChatConfig==null)?n:(t={Traffic_source:window.ChatConfig.BanID,expid:window.ChatConfig.ExpertID,sale:window.ChatConfig.HasSale},jQuery.extend(n,t),n)},n.extendAnyliticsData=function(n){jQuery.extend(data,n)},n.trackEventByObject=function(n){var t,r,i;if(n){t="event"in n;try{r=this.collectSuperProperties(),jQuery.extend(n,r),dataLayer.push(n),t&&console.log("DataLayer Event:'"+n.event+"'")}catch(u){i="",t&&(i=n.event+" "),console.log(i+"event failed ex: "+u)}}},n}(),EmojiHelper=function(){"use strict";var n={};return n.isEmoji=function(n){var t=!1,i;return typeof emojione!="undefined"&&(i=emojione.toShort(n),t=i.toUpperCase()!==n.toUpperCase()),t},n.parseUnicodeSmiliesToShortName=function(t){return typeof emojione!="undefined"&&n.isEmoji(t)&&(t=emojione.toShort(t)),t},n}(),SessionCommonModule=function(){"use strict";function o(n,t,o,s,h){var l=0,c,a;switch(h){case r.OFFLINE_MSG:l=e;break;case r.ONLINE_CHAT:case r.ONLINE_VOICE:l=f}return t=t||i.fee,t=parseFloat(t),s=s||i.expertName,c=t*l,c=Math.round(c*1e3)/1e3,a={transactionId:parseInt(n),transactionTotal:c,transactionProducts:[{sku:parseInt(o),name:s,category:h,price:c,quantity:1}]},u=$.extend(!0,{},a),u.sessionFactor=l,u.feePerMinute=t,a}function s(n,t,i,r,u,f){var e=o(t,i,r,u,f);return $.extend(n,e),n}function h(n){i.expertName=n}function c(){return i.expertName}function l(){return i.fee}function a(n){i.fee=parseFloat(n)}function v(){return i.startChatDate}function y(n){i.startChatDate=n}function p(){return u}var f=.55,e=.3,i={fee:0,expertName:"",startChatDate:null},u,r={ONLINE_VOICE:"OnlineVoice",ONLINE_CHAT:"OnlineChat",OFFLINE_MSG:"Offline"};return Object.freeze(r),{setTransactionEventData:s,sessionType:r,setFee:a,getFee:l,setExpertName:h,getExpertName:c,getTransactionEventData:p,setStartChatDate:y,getStartChatDate:v}}(window),sessionPaid=!1;if(document.all&&(document.onkeydown=function(){var n=116;if(n==event.keyCode)return event.keyCode=27,!1}),function(){"use strict";function n(n,t){this.message="",this.containerElement=n,this.bubbleElement=t,this.flushMessageToUI=function(){this.message.trim()==""?this.bubbleElement.hide():this.bubbleElement.show(),this.bubbleElement.text(this.message)},this.addNewText=function(n){n!==undefined&&(this.message+=n,this.flushMessageToUI())},this.deleteLastChar=function(){var n=this.message.length,t=n<=0;return t||(this.message=this.message.substring(0,n-1),this.flushMessageToUI()),t},this.isEmpty=function(){return this.message.length==0},this.tryPullLastWord=function(){var n=this.message.lastIndexOf(" "),t;return n==-1?null:n+1==this.message.length?(this.deleteLastChar(),""):(t=this.message.substring(n+1,this.message.length),this.message=this.message.substring(0,n),t)}}window.MessageContainer=n}(),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(n){"use strict";var t=n.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1||t[0]>2)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 3");}(jQuery),+function(n){"use strict";function t(){var i=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(void 0!==i.style[n])return{end:t[n]};return!1}n.fn.emulateTransitionEnd=function(t){var i=!1,u=this,r;n(this).one("bsTransitionEnd",function(){i=!0});return r=function(){i||n(u).trigger(n.support.transition.end)},setTimeout(r,t),this},n(function(){n.support.transition=t(),n.support.transition&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(t){if(n(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery),+function(n){"use strict";function u(i){return this.each(function(){var r=n(this),u=r.data("bs.alert");u||r.data("bs.alert",u=new t(this)),"string"==typeof i&&u[i].call(r)})}var i='[data-dismiss="alert"]',t=function(t){n(t).on("click",i,this.close)},r;t.VERSION="3.3.6",t.TRANSITION_DURATION=150,t.prototype.close=function(i){function e(){r.detach().trigger("closed.bs.alert").remove()}var f=n(this),u=f.attr("data-target"),r;u||(u=f.attr("href"),u=u&&u.replace(/.*(?=#[^\s]*$)/,"")),r=n(u),i&&i.preventDefault(),r.length||(r=f.closest(".alert")),r.trigger(i=n.Event("close.bs.alert")),i.isDefaultPrevented()||(r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e())},r=n.fn.alert,n.fn.alert=u,n.fn.alert.Constructor=t,n.fn.alert.noConflict=function(){return n.fn.alert=r,this},n(document).on("click.bs.alert.data-api",i,t.prototype.close)}(jQuery),+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.button"),f="object"==typeof i&&i;r||u.data("bs.button",r=new t(this,f)),"toggle"==i?r.toggle():i&&r.setState(i)})}var t=function(i,r){this.$element=n(i),this.options=n.extend({},t.DEFAULTS,r),this.isLoading=!1},r;t.VERSION="3.3.6",t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(t){var r="disabled",i=this.$element,f=i.is("input")?"val":"html",u=i.data();t+="Text",null==u.resetText&&i.data("resetText",i[f]()),setTimeout(n.proxy(function(){i[f](null==u[t]?this.options[t]:u[t]),"loadingText"==t?(this.isLoading=!0,i.addClass(r).attr(r,r)):this.isLoading&&(this.isLoading=!1,i.removeClass(r).removeAttr(r))},this),0)},t.prototype.toggle=function(){var t=!0,i=this.$element.closest('[data-toggle="buttons"]'),n;i.length?(n=this.$element.find("input"),"radio"==n.prop("type")?(n.prop("checked")&&(t=!1),i.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")):(this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active"))},r=n.fn.button,n.fn.button=i,n.fn.button.Constructor=t,n.fn.button.noConflict=function(){return n.fn.button=r,this},n(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var r=n(t.target);r.hasClass("btn")||(r=r.closest(".btn")),i.call(r,"toggle"),n(t.target).is('input[type="radio"]')||n(t.target).is('input[type="checkbox"]')||t.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){n(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.carousel"),f=n.extend({},t.DEFAULTS,u.data(),"object"==typeof i&&i),e="string"==typeof i?i:f.slide;r||u.data("bs.carousel",r=new t(this,f)),"number"==typeof i?r.to(i):e?r[e]():f.interval&&r.pause().cycle()})}var t=function(t,i){this.$element=n(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",n.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",n.proxy(this.pause,this)).on("mouseleave.bs.carousel",n.proxy(this.cycle,this))},u,r;t.VERSION="3.3.6",t.TRANSITION_DURATION=600,t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},t.prototype.keydown=function(n){if(!/input|textarea/i.test(n.target.tagName)){switch(n.which){case 37:this.prev();break;case 39:this.next();break;default:return}n.preventDefault()}},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(n.proxy(this.next,this),this.options.interval)),this},t.prototype.getItemIndex=function(n){return this.$items=n.parent().children(".item"),this.$items.index(n||this.$active)},t.prototype.getItemForDirection=function(n,t){var i=this.getItemIndex(t),f="prev"==n&&0===i||"next"==n&&i==this.$items.length-1,r,u;return f&&!this.options.wrap?t:(r="prev"==n?-1:1,u=(i+r)%this.$items.length,this.$items.eq(u))},t.prototype.to=function(n){var i=this,t=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(n>this.$items.length-1)&&!(0>n))return this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(n)}):t==n?this.pause().cycle():this.slide(n>t?"next":"prev",this.$items.eq(n))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&n.support.transition&&(this.$element.trigger(n.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){if(!this.sliding)return this.slide("next")},t.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},t.prototype.slide=function(i,r){var e=this.$element.find(".item.active"),u=r||this.getItemForDirection(i,e),l=this.interval,f="next"==i?"left":"right",a=this,o,s,h,c;return u.hasClass("active")?this.sliding=!1:(o=u[0],s=n.Event("slide.bs.carousel",{relatedTarget:o,direction:f}),(this.$element.trigger(s),!s.isDefaultPrevented())?((this.sliding=!0,l&&this.pause(),this.$indicators.length)&&(this.$indicators.find(".active").removeClass("active"),h=n(this.$indicators.children()[this.getItemIndex(u)]),h&&h.addClass("active")),c=n.Event("slid.bs.carousel",{relatedTarget:o,direction:f}),n.support.transition&&this.$element.hasClass("slide")?(u.addClass(i),u[0].offsetWidth,e.addClass(f),u.addClass(f),e.one("bsTransitionEnd",function(){u.removeClass([i,f].join(" ")).addClass("active"),e.removeClass(["active",f].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger(c)},0)}).emulateTransitionEnd(t.TRANSITION_DURATION)):(e.removeClass("active"),u.addClass("active"),this.sliding=!1,this.$element.trigger(c)),l&&this.cycle(),this):void 0)},u=n.fn.carousel,n.fn.carousel=i,n.fn.carousel.Constructor=t,n.fn.carousel.noConflict=function(){return n.fn.carousel=u,this},r=function(t){var o,r=n(this),u=n(r.attr("data-target")||(o=r.attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"")),e,f;u.hasClass("carousel")&&(e=n.extend({},u.data(),r.data()),f=r.attr("data-slide-to"),f&&(e.interval=!1),i.call(u,e),f&&u.data("bs.carousel").to(f),t.preventDefault())},n(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r),n(window).on("load",function(){n('[data-ride="carousel"]').each(function(){var t=n(this);i.call(t,t.data())})})}(jQuery),+function(n){"use strict";function r(t){var i,r=t.attr("data-target")||(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return n(r)}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.collapse"),f=n.extend({},t.DEFAULTS,u.data(),"object"==typeof i&&i);!r&&f.toggle&&/show|hide/.test(i)&&(f.toggle=!1),r||u.data("bs.collapse",r=new t(this,f)),"string"==typeof i&&r[i]()})}var t=function(i,r){this.$element=n(i),this.options=n.extend({},t.DEFAULTS,r),this.$trigger=n('[data-toggle="collapse"][href="#'+i.id+'"],[data-toggle="collapse"][data-target="#'+i.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()},u;t.VERSION="3.3.6",t.TRANSITION_DURATION=350,t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var n=this.$element.hasClass("width");return n?"width":"height"},t.prototype.show=function(){var f,r,e,u,o,s;if(!this.transitioning&&!this.$element.hasClass("in")&&(r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing"),!(r&&r.length&&(f=r.data("bs.collapse"),f&&f.transitioning))&&(e=n.Event("show.bs.collapse"),this.$element.trigger(e),!e.isDefaultPrevented()))){if(r&&r.length&&(i.call(r,"hide"),f||r.data("bs.collapse",null)),u=this.dimension(),this.$element.removeClass("collapse").addClass("collapsing")[u](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1,o=function(){this.$element.removeClass("collapsing").addClass("collapse in")[u](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")},!n.support.transition)return o.call(this);s=n.camelCase(["scroll",u].join("-")),this.$element.one("bsTransitionEnd",n.proxy(o,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[u](this.$element[0][s])}},t.prototype.hide=function(){var r,i,u;if(!this.transitioning&&this.$element.hasClass("in")&&(r=n.Event("hide.bs.collapse"),this.$element.trigger(r),!r.isDefaultPrevented()))return i=this.dimension(),this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1,u=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")},n.support.transition?void this.$element[i](0).one("bsTransitionEnd",n.proxy(u,this)).emulateTransitionEnd(t.TRANSITION_DURATION):u.call(this)},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},t.prototype.getParent=function(){return n(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(n.proxy(function(t,i){var u=n(i);this.addAriaAndCollapsedClass(r(u),u)},this)).end()},t.prototype.addAriaAndCollapsedClass=function(n,t){var i=n.hasClass("in");n.attr("aria-expanded",i),t.toggleClass("collapsed",!i).attr("aria-expanded",i)},u=n.fn.collapse,n.fn.collapse=i,n.fn.collapse.Constructor=t,n.fn.collapse.noConflict=function(){return n.fn.collapse=u,this},n(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var u=n(this);u.attr("data-target")||t.preventDefault();var f=r(u),e=f.data("bs.collapse"),o=e?"toggle":u.data();i.call(f,o)})}(jQuery),+function(n){"use strict";function r(t){var i=t.attr("data-target"),r;return i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),r=i&&n(i),r&&r.length?r:t.parent()}function u(t){t&&3===t.which||(n(o).remove(),n(i).each(function(){var u=n(this),i=r(u),f={relatedTarget:this};i.hasClass("open")&&(t&&"click"==t.type&&/input|textarea/i.test(t.target.tagName)&&n.contains(i[0],t.target)||(i.trigger(t=n.Event("hide.bs.dropdown",f)),t.isDefaultPrevented()||(u.attr("aria-expanded","false"),i.removeClass("open").trigger(n.Event("hidden.bs.dropdown",f)))))}))}function e(i){return this.each(function(){var r=n(this),u=r.data("bs.dropdown");u||r.data("bs.dropdown",u=new t(this)),"string"==typeof i&&u[i].call(r)})}var o=".dropdown-backdrop",i='[data-toggle="dropdown"]',t=function(t){n(t).on("click.bs.dropdown",this.toggle)},f;t.VERSION="3.3.6",t.prototype.toggle=function(t){var f=n(this),i,o,e;if(!f.is(".disabled, :disabled")){if(i=r(f),o=i.hasClass("open"),u(),!o){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&n(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(n(this)).on("click",u),e={relatedTarget:this},i.trigger(t=n.Event("show.bs.dropdown",e)),t.isDefaultPrevented())return;f.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger(n.Event("shown.bs.dropdown",e))}return!1}},t.prototype.keydown=function(t){var e,o,s,h,f,u;if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)&&(e=n(this),t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled"))){if(o=r(e),s=o.hasClass("open"),!s&&27!=t.which||s&&27==t.which)return 27==t.which&&o.find(i).trigger("focus"),e.trigger("click");h=" li:not(.disabled):visible a",f=o.find(".dropdown-menu"+h),f.length&&(u=f.index(t.target),38==t.which&&u>0&&u--,40==t.which&&u<f.length-1&&u++,~u||(u=0),f.eq(u).trigger("focus"))}},f=n.fn.dropdown,n.fn.dropdown=e,n.fn.dropdown.Constructor=t,n.fn.dropdown.noConflict=function(){return n.fn.dropdown=f,this},n(document).on("click.bs.dropdown.data-api",u).on("click.bs.dropdown.data-api",".dropdown form",function(n){n.stopPropagation()}).on("click.bs.dropdown.data-api",i,t.prototype.toggle).on("keydown.bs.dropdown.data-api",i,t.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",t.prototype.keydown)}(jQuery),+function(n){"use strict";function i(i,r){return this.each(function(){var f=n(this),u=f.data("bs.modal"),e=n.extend({},t.DEFAULTS,f.data(),"object"==typeof i&&i);u||f.data("bs.modal",u=new t(this,e)),"string"==typeof i?u[i](r):e.show&&u.show(r)})}var t=function(t,i){this.options=i,this.$body=n(document.body),this.$element=n(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,n.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))},r;t.VERSION="3.3.6",t.TRANSITION_DURATION=300,t.BACKDROP_TRANSITION_DURATION=150,t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(n){return this.isShown?this.hide():this.show(n)},t.prototype.show=function(i){var r=this,u=n.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(u),this.isShown||u.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){r.$element.one("mouseup.dismiss.bs.modal",function(t){n(t.target).is(r.$element)&&(r.ignoreBackdropClick=!0)})}),this.backdrop(function(){var f=n.support.transition&&r.$element.hasClass("fade"),u;r.$element.parent().length||r.$element.appendTo(r.$body),r.$element.show().scrollTop(0),r.adjustDialog(),f&&r.$element[0].offsetWidth,r.$element.addClass("in"),r.enforceFocus(),u=n.Event("shown.bs.modal",{relatedTarget:i}),f?r.$dialog.one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(u)}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(u)}))},t.prototype.hide=function(i){i&&i.preventDefault(),i=n.Event("hide.bs.modal"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),n(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),n.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",n.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal())},t.prototype.enforceFocus=function(){n(document).off("focusin.bs.modal").on("focusin.bs.modal",n.proxy(function(n){this.$element[0]===n.target||this.$element.has(n.target).length||this.$element.trigger("focus")},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",n.proxy(function(n){27==n.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.prototype.resize=function(){this.isShown?n(window).on("resize.bs.modal",n.proxy(this.handleUpdate,this)):n(window).off("resize.bs.modal")},t.prototype.hideModal=function(){var n=this;this.$element.hide(),this.backdrop(function(){n.$body.removeClass("modal-open"),n.resetAdjustments(),n.resetScrollbar(),n.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(i){var e=this,f=this.$element.hasClass("fade")?"fade":"",r,u;if(this.isShown&&this.options.backdrop){if(r=n.support.transition&&f,this.$backdrop=n(document.createElement("div")).addClass("modal-backdrop "+f).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",n.proxy(function(n){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(n.target===n.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;r?this.$backdrop.one("bsTransitionEnd",i).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):i()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),u=function(){e.removeBackdrop(),i&&i()},n.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",u).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):u()):i&&i()},t.prototype.handleUpdate=function(){this.adjustDialog()},t.prototype.adjustDialog=function(){var n=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&n?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!n?this.scrollbarWidth:""})},t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},t.prototype.checkScrollbar=function(){var n=window.innerWidth,t;n||(t=document.documentElement.getBoundingClientRect(),n=t.right-Math.abs(t.left)),this.bodyIsOverflowing=document.body.clientWidth<n,this.scrollbarWidth=this.measureScrollbar()},t.prototype.setScrollbar=function(){var n=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",n+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},t.prototype.measureScrollbar=function(){var n=document.createElement("div"),t;return n.className="modal-scrollbar-measure",this.$body.append(n),t=n.offsetWidth-n.clientWidth,this.$body[0].removeChild(n),t},r=n.fn.modal,n.fn.modal=i,n.fn.modal.Constructor=t,n.fn.modal.noConflict=function(){return n.fn.modal=r,this},n(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=n(this),f=r.attr("href"),u=n(r.attr("data-target")||f&&f.replace(/.*(?=#[^\s]+$)/,"")),e=u.data("bs.modal")?"toggle":n.extend({remote:!/#/.test(f)&&f},u.data(),r.data());r.is("a")&&t.preventDefault(),u.one("show.bs.modal",function(n){n.isDefaultPrevented()||u.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})}),i.call(u,e,this)})}(jQuery),+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tooltip"),f="object"==typeof i&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.tooltip",r=new t(this,f)),"string"==typeof i&&r[i]())})}var t=function(n,t){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",n,t)},i;t.VERSION="3.3.6",t.TRANSITION_DURATION=150,t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner"><\/div><\/div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,i,r){var f,e,u,o,s;if(this.enabled=!0,this.type=t,this.$element=n(i),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&n(n.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(f=this.options.trigger.split(" "),e=f.length;e--;)if(u=f[e],"click"==u)this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else"manual"!=u&&(o="hover"==u?"mouseenter":"focusin",s="hover"==u?"mouseleave":"focusout",this.$element.on(o+"."+this.type,this.options.selector,n.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,n.proxy(this.leave,this)));this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=n.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&n.each(this._options,function(n,r){i[n]!=r&&(t[n]=r)}),t},t.prototype.enter=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState["focusin"==t.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState?void(i.hoverState="in"):(clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},t.prototype.isInStateTrue=function(){for(var n in this.inState)if(this.inState[n])return!0;return!1},t.prototype.leave=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState["focusout"==t.type?"focus":"hover"]=!1),i.isInStateTrue()?void 0:(clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide())},t.prototype.show=function(){var c=n.Event("show.bs."+this.type),l,p,e,w,h;if(this.hasContent()&&this.enabled){if(this.$element.trigger(c),l=n.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]),c.isDefaultPrevented()||!l)return;var u=this,r=this.tip(),a=this.getUID(this.type);this.setContent(),r.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&r.addClass("fade");var i="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,v=/\s?auto?\s?/i,y=v.test(i);y&&(i=i.replace(v,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(i).data("bs."+this.type,this),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var f=this.getPosition(),o=r[0].offsetWidth,s=r[0].offsetHeight;y&&(p=i,e=this.getPosition(this.$viewport),i="bottom"==i&&f.bottom+s>e.bottom?"top":"top"==i&&f.top-s<e.top?"bottom":"right"==i&&f.right+o>e.width?"left":"left"==i&&f.left-o<e.left?"right":i,r.removeClass(p).addClass(i)),w=this.getCalculatedOffset(i,f,o,s),this.applyPlacement(w,i),h=function(){var n=u.hoverState;u.$element.trigger("shown.bs."+u.type),u.hoverState=null,"out"==n&&u.leave(u)},n.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",h).emulateTransitionEnd(t.TRANSITION_DURATION):h()}},t.prototype.applyPlacement=function(t,i){var r=this.tip(),l=r[0].offsetWidth,e=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),s=parseInt(r.css("margin-left"),10),h,f,u;isNaN(o)&&(o=0),isNaN(s)&&(s=0),t.top+=o,t.left+=s,n.offset.setOffset(r[0],n.extend({using:function(n){r.css({top:Math.round(n.top),left:Math.round(n.left)})}},t),0),r.addClass("in"),h=r[0].offsetWidth,f=r[0].offsetHeight,"top"==i&&f!=e&&(t.top=t.top+e-f),u=this.getViewportAdjustedDelta(i,t,h,f),u.left?t.left+=u.left:t.top+=u.top;var c=/top|bottom/.test(i),a=c?2*u.left-l+h:2*u.top-e+f,v=c?"offsetWidth":"offsetHeight";r.offset(t),this.replaceArrow(a,r[0][v],c)},t.prototype.replaceArrow=function(n,t,i){this.arrow().css(i?"left":"top",50*(1-n/t)+"%").css(i?"top":"left","")},t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](t),n.removeClass("fade in top bottom left right")},t.prototype.hide=function(i){function f(){"in"!=u.hoverState&&r.detach(),u.$element.removeAttr("aria-describedby").trigger("hidden.bs."+u.type),i&&i()}var u=this,r=n(this.$tip),e=n.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:(r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",f).emulateTransitionEnd(t.TRANSITION_DURATION):f(),this.hoverState=null,this)},t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||"string"!=typeof n.attr("data-original-title"))&&n.attr("data-original-title",n.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){t=t||this.$element;var u=t[0],r="BODY"==u.tagName,i=u.getBoundingClientRect();null==i.width&&(i=n.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var f=r?{top:0,left:0}:t.offset(),e={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},o=r?{width:n(window).width(),height:n(window).height()}:null;return n.extend({},i,e,o,f)},t.prototype.getCalculatedOffset=function(n,t,i,r){return"bottom"==n?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==n?{top:t.top-r,left:t.left+t.width/2-i/2}:"left"==n?{top:t.top+t.height/2-r/2,left:t.left-i}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(n,t,i,r){var f={top:0,left:0},e,u,o,s,h,c;return this.$viewport?(e=this.options.viewport&&this.options.viewport.padding||0,u=this.getPosition(this.$viewport),/right|left/.test(n)?(o=t.top-e-u.scroll,s=t.top+e-u.scroll+r,o<u.top?f.top=u.top-o:s>u.top+u.height&&(f.top=u.top+u.height-s)):(h=t.left-e,c=t.left+e+i,h<u.left?f.left=u.left-h:c>u.right&&(f.left=u.left+u.width-c)),f):f},t.prototype.getTitle=function(){var i,t=this.$element,n=this.options;return i=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},t.prototype.getUID=function(n){do n+=~~(1e6*Math.random());while(document.getElementById(n));return n},t.prototype.tip=function(){if(!this.$tip&&(this.$tip=n(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var i=this;t&&(i=n(t.currentTarget).data("bs."+this.type),i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i))),t?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},t.prototype.destroy=function(){var n=this;clearTimeout(this.timeout),this.hide(function(){n.$element.off("."+n.type).removeData("bs."+n.type),n.$tip&&n.$tip.detach(),n.$tip=null,n.$arrow=null,n.$viewport=null})},i=n.fn.tooltip,n.fn.tooltip=r,n.fn.tooltip.Constructor=t,n.fn.tooltip.noConflict=function(){return n.fn.tooltip=i,this}}(jQuery),+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.popover"),f="object"==typeof i&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.popover",r=new t(this,f)),"string"==typeof i&&r[i]())})}var t=function(n,t){this.init("popover",n,t)},i;if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.6",t.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"><\/div><h3 class="popover-title"><\/h3><div class="popover-content"><\/div><\/div>'}),t.prototype=n.extend({},n.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var n=this.tip(),i=this.getTitle(),t=this.getContent();n.find(".popover-title")[this.options.html?"html":"text"](i),n.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof t?"html":"append":"text"](t),n.removeClass("fade top bottom left right in"),n.find(".popover-title").html()||n.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var t=this.$element,n=this.options;return t.attr("data-content")||("function"==typeof n.content?n.content.call(t[0]):n.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},i=n.fn.popover,n.fn.popover=r,n.fn.popover.Constructor=t,n.fn.popover.noConflict=function(){return n.fn.popover=i,this}}(jQuery),+function(n){"use strict";function t(i,r){this.$body=n(document.body),this.$scrollElement=n(n(i).is(document.body)?window:i),this.options=n.extend({},t.DEFAULTS,r),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",n.proxy(this.process,this)),this.refresh(),this.process()}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.scrollspy"),f="object"==typeof i&&i;r||u.data("bs.scrollspy",r=new t(this,f)),"string"==typeof i&&r[i]()})}t.VERSION="3.3.6",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t=this,i="offset",r=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),n.isWindow(this.$scrollElement[0])||(i="position",r=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var f=n(this),u=f.data("target")||f.attr("href"),t=/^#./.test(u)&&n(u);return t&&t.length&&t.is(":visible")&&[[t[i]().top+r,u]]||null}).sort(function(n,t){return n[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},t.prototype.process=function(){var n,i=this.$scrollElement.scrollTop()+this.options.offset,f=this.getScrollHeight(),e=this.options.offset+f-this.$scrollElement.height(),t=this.offsets,r=this.targets,u=this.activeTarget;if(this.scrollHeight!=f&&this.refresh(),i>=e)return u!=(n=r[r.length-1])&&this.activate(n);if(u&&i<t[0])return this.activeTarget=null,this.clear();for(n=t.length;n--;)u!=r[n]&&i>=t[n]&&(void 0===t[n+1]||i<t[n+1])&&this.activate(r[n])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=n(r).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){n(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var r=n.fn.scrollspy;n.fn.scrollspy=i,n.fn.scrollspy.Constructor=t,n.fn.scrollspy.noConflict=function(){return n.fn.scrollspy=r,this},n(window).on("load.bs.scrollspy.data-api",function(){n('[data-spy="scroll"]').each(function(){var t=n(this);i.call(t,t.data())})})}(jQuery),+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tab");r||u.data("bs.tab",r=new t(this)),"string"==typeof i&&r[i]()})}var t=function(t){this.element=n(t)},u,i;t.VERSION="3.3.6",t.TRANSITION_DURATION=150,t.prototype.show=function(){var t=this.element,f=t.closest("ul:not(.dropdown-menu)"),i=t.data("target"),u;if(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=f.find(".active:last a"),e=n.Event("hide.bs.tab",{relatedTarget:t[0]}),o=n.Event("show.bs.tab",{relatedTarget:r[0]});(r.trigger(e),t.trigger(o),o.isDefaultPrevented()||e.isDefaultPrevented())||(u=n(i),this.activate(t.closest("li"),f),this.activate(u,u.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:r[0]})}))}},t.prototype.activate=function(i,r,u){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),i.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),o?(i[0].offsetWidth,i.addClass("in")):i.removeClass("fade"),i.parent(".dropdown-menu").length&&i.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),u&&u()}var f=r.find("> .active"),o=u&&n.support.transition&&(f.length&&f.hasClass("fade")||!!r.find("> .fade").length);f.length&&o?f.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e(),f.removeClass("in")},u=n.fn.tab,n.fn.tab=r,n.fn.tab.Constructor=t,n.fn.tab.noConflict=function(){return n.fn.tab=u,this},i=function(t){t.preventDefault(),r.call(n(this),"show")};n(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery),+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.affix"),f="object"==typeof i&&i;r||u.data("bs.affix",r=new t(this,f)),"string"==typeof i&&r[i]()})}var t=function(i,r){this.options=n.extend({},t.DEFAULTS,r),this.$target=n(this.options.target).on("scroll.bs.affix.data-api",n.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",n.proxy(this.checkPositionWithEventLoop,this)),this.$element=n(i),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()},r;t.VERSION="3.3.6",t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0,target:window},t.prototype.getState=function(n,t,i,r){var u=this.$target.scrollTop(),f=this.$element.offset(),e=this.$target.height();if(null!=i&&"top"==this.affixed)return i>u?"top":!1;if("bottom"==this.affixed)return null!=i?u+this.unpin<=f.top?!1:"bottom":n-r>=u+e?!1:"bottom";var o=null==this.affixed,s=o?u:f.top,h=o?e:t;return null!=i&&i>=u?"top":null!=r&&s+h>=n-r?"bottom":!1},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var n=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-n},t.prototype.checkPositionWithEventLoop=function(){setTimeout(n.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){var i,e,o;if(this.$element.is(":visible")){var s=this.$element.height(),r=this.options.offset,f=r.top,u=r.bottom,h=Math.max(n(document).height(),n(document.body).height());if("object"!=typeof r&&(u=f=r),"function"==typeof f&&(f=r.top(this.$element)),"function"==typeof u&&(u=r.bottom(this.$element)),i=this.getState(h,s,f,u),this.affixed!=i){if(null!=this.unpin&&this.$element.css("top",""),e="affix"+(i?"-"+i:""),o=n.Event(e+".bs.affix"),this.$element.trigger(o),o.isDefaultPrevented())return;this.affixed=i,this.unpin="bottom"==i?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(e).trigger(e.replace("affix","affixed")+".bs.affix")}"bottom"==i&&this.$element.offset({top:h-s-u})}},r=n.fn.affix,n.fn.affix=i,n.fn.affix.Constructor=t,n.fn.affix.noConflict=function(){return n.fn.affix=r,this},n(window).on("load",function(){n('[data-spy="affix"]').each(function(){var r=n(this),t=r.data();t.offset=t.offset||{},null!=t.offsetBottom&&(t.offset.bottom=t.offsetBottom),null!=t.offsetTop&&(t.offset.top=t.offsetTop),i.call(r,t)})})}(jQuery),function(n){var f=1,e=5,i=1,t=function(t,i){return t===null||t===undefined||t==[]||t===""||i&&n.trim(t)===""},r=function(n,i,r){var u=t(n.data(i))?n.attr(i):n.data(i);return u?u:r[i]},u=function(i,u){this.$element=n(i),this.min=this._parseAttr("min",u),this.max=this._parseAttr("max",u),this.step=this._parseAttr("step",u),this.disabled=r(this.$element,"disabled",u),this.readonly=r(this.$element,"readonly",u),this.rtl=u.rtl,this.showClear=u.showClear,this.showCaption=u.showCaption,this.size=u.size,this.defaultCaption=u.defaultCaption,this.starCaptions=u.starCaptions,this.starCaptionClasses=u.starCaptionClasses,this.clearButton=u.clearButton,this.clearButtonTitle=u.clearButtonTitle,this.clearCaption=u.clearCaption,this.clearCaptionClass=u.clearCaptionClass,this.clearValue=u.clearValue,this.inactive=this.disabled||this.readonly,this.inputValue=this.$element.val(),this.$clearElement=u.clearElement,this.$captionElement=u.captionElement,this.$container=this.createContainer(),this.$star=this.$container.children("s"),this.$stars=this.$container.find("s"),this.$clear=t(this.$clearElement)?this.$container.find(".clear-rating"):this.$clearElement,this.$caption=t(this.$captionElement)?this.$container.find(".caption"):this.$captionElement,this._init(),this.initialValue=parseFloat(this.$element.val())};u.prototype={constructor:u,_parseAttr:function(n,u){var l=this,h=l.$element,s,o,c;return h.attr("type")==="number"?(s=r(h,n,u),o=i,n==="min"?o=f:n==="max"?o=e:n==="step"&&(o=i),c=t(s)?o:s,parseFloat(c)):parseFloat(u[n])},_init:function(){var t=this;t.$element.before(t.$container),t.$element.hide();t.$star.on("click",function(n){t.inactive||t.change(n)});t.$clear.on("click",n.proxy(t.clear,t));n(t.$element[0].form).on("reset",n.proxy(t.reset,t))},createContainer:function(){var t=this,i=t.rtl?"star-rating-rtl":"star-rating",r,u;return i+=t.inactive?t.disabled?" "+i+"-disabled ":" ":" "+i+"-active ",i+="rating-"+t.size,r=t.renderRating(),u=n(document.createElement("div")).attr({"class":i}).html(r),u},renderRating:function(){var n=this,t=n.renderStars(),i=n.renderClear(),r=n.renderCaption();return n.rtl?r+t+i:i+t+r},renderStars:function(){for(var u="",f="",n=this,e=n.step>0?n.step:i,o=parseInt(n.max/e),r=n.min;r<=n.max;r+=e)u+=!t(n.inputValue)&&r<=n.inputValue?'<s class="rated">':"<s>",f+="<\/s>";return u+f},renderClear:function(){var n=this,i;return n.showClear?(i=n.inactive?"clear-rating":"clear-rating clear-rating-active",!t(n.$clearElement))?(n.$clearElement.removeClass(i).addClass(i).attr({title:n.clearButtonTitle}),n.$clearElement.html(n.clearButton),""):'<div class="'+i+'" title="'+n.clearButtonTitle+'">'+n.clearButton+"<\/div>":""},renderCaption:function(){var n=this,r=n.inputValue,i;return n.showCaption?(i=n.fetchCaption(r),!t(n.$captionElement))?(n.$captionElement.removeClass("caption").addClass("caption").attr({title:n.clearButtonTitle}),n.$captionElement.html(i),""):'<div class="caption">'+i+"<\/div>":""},fetchCaption:function(n){var i=this,r=parseFloat(n),u=t(i.starCaptionClasses[r])?i.clearCaptionClass:i.starCaptionClasses[r],f=t(i.starCaptions[r])?i.clearCaption:i.starCaptions[r];return'<span class="'+u+'">'+f+"<\/span>"},change:function(i){var r=this,u=n(i.target).parentsUntil("div").length+1;u=(u-1)*r.step+r.min;var f=!t(r.starCaptions[u]),o=f?r.starCaptionClasses[u]:r.clearCaptionClass,s=f?r.starCaptions[u]:r.defaultCaption.replace(/\{rating\}/g,u),e='<span class="'+o+'">'+s+"<\/span>";r.$element.val(u),r.$caption.html(e),r.$stars.removeClass("rated"),n(i.target).removeClass("rated").addClass("rated"),n(i.target).parentsUntil("div","s").removeClass("rated").addClass("rated"),r.$element.trigger("rating.change",[u,e])},clear:function(){var n=this,t='<span class="'+n.clearCaptionClass+'">'+n.clearCaption+"<\/span>";n.$stars.removeClass("rated"),n.$caption.html(t),n.$element.val(n.clearValue),n.$element.trigger("rating.clear")},reset:function(){var n=this,r=n.$container,i=n.initialValue,u=n.$caption,f="",e,t;if(n.clear(),i){for(e=parseInt(i/n.step),r.find("s").addClass("rated"),t=1;t<=e;t++)f+=t===1?"s":" > s";r.find(f+" > s").removeClass("rated"),u&&u.html(n.fetchCaption(i))}n.$element.trigger("rating.reset")}},n.fn.rating=function(t){var i=Array.apply(null,arguments);return i.shift(),this.each(function(){var f=n(this),r=f.data("rating"),e=typeof t=="object"&&t;r||f.data("rating",r=new u(this,n.extend({},n.fn.rating.defaults,e,n(this).data()))),typeof t=="string"&&r[t].apply(r,i)})},n.fn.rating.defaults={min:f,max:e,step:i,disabled:!1,readonly:!1,rtl:!1,size:"md",showClear:!0,showCaption:!0,defaultCaption:"{rating} Stars",starCaptions:{1:"One Star",2:"Two Stars",3:"Three Stars",4:"Four Stars",5:"Five Stars"},starCaptionClasses:{1:"label label-danger",2:"label label-warning",3:"label label-info",4:"label label-primary",5:"label label-success"},clearButton:'<i class="glyphicon glyphicon-minus-sign"><\/i>',clearButtonTitle:"Clear",clearCaption:"Not Rated",clearCaptionClass:"label label-default",clearValue:0,captionElement:null,clearElement:null}}(jQuery),function(){function c(i,u){var f,h,s,c;if(e=i,o=u,f=$("input.rating[type=number]"),f.length>0){f.rating({starCaptions:{1:"Very poor",2:"Below expectations",3:"Average",4:"Good",5:"Outstanding"},showClear:!1,clearCaption:""});f.on("rating.change",function(){var n=$(this).val();n<3?$("#lowRatingPannel").slideDown():$("#lowRatingPannel").slideUp(),$("#RateExpert").removeClass("btn-rate-disabled")})}s=function(){var n=this;setTimeout(function(){n.style.cssText="height:"+h+"px",n.scrollHeight>h&&(n.style.cssText="height:"+n.scrollHeight+"px")},0)},t=$("#RatingComment"),h=t.prop("scrollHeight");$("#RateExpert").on("click",a);$("#RateLater, #rateExpertClosePopupBtn").on("click",v);t.on("keydown",s);t.on("paste",s);t.on("cut",s);$("input:radio[name='rgRating']").on("click",function(){$("html, body").animate({scrollTop:$(document).height()-$(window).height()},"slow")});c=JSON.stringify(ChatManager.data),c===null?r("#rating-area-notifiy","No session to rate",60):(n={},n.data=JSON.parse(c),$("#expert-pic").attr("src","//expertsimages.kassrv.com/experts-pictures/small/pic"+n.data.ExpertID+".jpg"),$("#expert-name").text(n.data.expertName),$("#expert-fee-amount").text(n.data.expertFee))}function r(n,t,i){$(n).text(" "+t),setTimeout(function(){$(n).text("")},1e3*i)}function s(){return n!==null}function l(n,t,i){return s()?n===0||n>5?(r("#rating-area-notifiy","Please select a rating star",60),!1):i.val().trim()==""?(r("#rating-area-notifiy","Please write a rating comment",60),!1):!0:!1}function h(n,t,i){$("#RateExpert").addClass("btn-rate-disabled"),$.ajax({type:"POST",url:n,cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json",success:function(n){n.d||n.d===7?console.info(i.name+" success"):console.error(i.name+" failure"),typeof isMobileNative!="undefined"&&isMobileNative?typeof Native!="undefined"&&Native("GoHomePage",""):i.callback(t.ratingValue,t.comment)},error:function(){r("#rating-area-notifiy","Failed to send your rating, please try again later.",60),$("#RateExpert").removeClass("btn-rate-disabled")}})}function a(){var s=parseInt(Number($("input.rating[type=number]").val())),a=u,v=f,o="",c=$("input:radio[name='rgRating']:checked"),r={};l(s,c,t)&&(o=$('label[for="rad'+c.val()+'"]').text(),r.guid=n.data.Guid,r.comment=t.val(),r.ratingValue=s,r.sessionID=n.data.SessionID,r.memberID=n.data.MemberID,r.expertID=n.data.ExpertID,r.allowExpertContact=v,r.addToFavoriteList=a,r.ratingReason=o===""?null:o,h("/Webservices/Ajax/RatingService.asmx/RateExpert",r,{name:i[i.RateExpert],callback:e}))}function v(){var r=u,e=f,t={};s()&&(t.guid=n.data.Guid,t.memberID=n.data.MemberID,t.expertID=n.data.ExpertID,t.allowExpertContact=e,t.addToFavoriteList=r,h("/Webservices/Ajax/RatingService.asmx/AddToFavoriteList",t,{name:i[i.AddToFavorites],callback:o}))}var u=!0,f=!0,n=null,t=null,i={AddToFavorites:1,1:"AddToFavorites",RateExpert:2,2:"RateExpert"},e,o;window.ChatRateExpert={init:c}}(),TagManagerHelper=function(){"use strict";var i=window._pageEventsData!=="undefined"&&window._pageEventsData||{},t={},n={cookieName:"dataLayerHistory",getCookieKey:function(){var n="anonymous";return typeof WebSettings!="undefined"&&WebSettings.getUser&&(n=WebSettings.getUser().memberId),n},cookiesApiSupported:function(){return typeof Cookies!="undefined"&&Cookies?!0:!1},get:function(){if(n.cookiesApiSupported()&&Cookies.getJSON){var t=Cookies.getJSON(n.cookieName);return t||{}}return{}},isExist:function(t){var i=n.get(),r=n.getCookieKey();return i&&i[r]&&i[r].events&&i[r].events.indexOf(t)!==-1},add:function(t){if(n.cookiesApiSupported()&&!n.isExist(t)&&Cookies.set){var i=n.get(),r=n.getCookieKey();i[r]||(i[r]={}),i[r].events||(i[r].events=[]),i[r].events.push(t),Cookies.set(n.cookieName,i)}}};return t.PropertyGroups={expert:"ExpertData",category:"CategoryData",session:"SessionData"},t.VariantType={email:"Email",chat:"Chat",voice:"Voice"},t.HomePageCategories={education:"education-tutoring",business:"business-finance",computers:"computers-programming",counseling:"professional-counseling",health:"health-and-medicine"},t.CheckoutSteps={clickSend:1,sendMessage:2,clickHire:3,hireComplete:4,approveInvoice:5},t.eventsHistory=n,t.importProperties=function(n){var u={},r,t;if(i&&n&&n.constructor&&n.constructor.name==="Array")for(r=0;r<n.length;r++)t=n[r],i[t]&&(u[t]={},$.extend(u[t],i[t]));return u},t.submitEvent=function(t,i,r){var f,u,o,e,s,h,c;if(i&&i.constructor.name==="Array"&&i.length>0)for(f=0;f<i.length;f++)if(u=i[f],u&&typeof u=="object"&&Object.keys(u).length>0)for(o=Object.keys(u),e=0;e<o.length;e++)s=o[e],typeof u[s]=="object"?$.extend(t,u[s]):$.extend(t,u);h=function(){dataLayer.push(t),console.info("TagManagerEvent:",t),n.add(t.event)},c=function(i){dataLayer.push(t),console.info("TagManagerEvent:",t),n.add(t.event+i)},r&&r.submitOnlyOnce?n.isExist(t.event)||h():r&&r.submitOnlyOncePerExpert?n.isExist(t.event+r.expertId)||c(r.expertId):h()},t}(),function(){"use strict";var t={};t.sessionStarted=function(n){n=n||{};var t=window.TagManagerHelper.importProperties([window.TagManagerHelper.PropertyGroups.category,window.TagManagerHelper.PropertyGroups.expert]),i={event:"StartFreeSession"};window.TagManagerHelper.submitEvent(i,[n,t])},window._currentPageView=window._currentPageView?$.extend(window._currentPageView,t):t}(window._currentPageView),function(n,t){if(typeof define=="function"&&define.amd)define(["exports","module"],t);else if(typeof exports!="undefined"&&typeof module!="undefined")t(exports,module);else{var i={exports:{}};t(i.exports,i),n.autosize=i.exports}}(this,function(n,t){"use strict";function f(n){function l(){var r=window.getComputedStyle(n,null);r.resize==="vertical"?n.style.resize="none":r.resize==="both"&&(n.style.resize="horizontal"),i=r.boxSizing==="content-box"?-(parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)):parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),isNaN(i)&&(i=0),t()}function c(t){var i=n.style.width;n.style.width="0px",n.offsetWidth,n.style.width=i,n.style.overflowY=t}function a(n){for(var t=[];n&&n.parentNode&&n.parentNode instanceof Element;)n.parentNode.scrollTop&&t.push({node:n.parentNode,scrollTop:n.parentNode.scrollTop}),n=n.parentNode;return t}function e(){var u=n.style.height,f=a(n),t=document.documentElement&&document.documentElement.scrollTop,r;if(n.style.height="",r=n.scrollHeight+i,n.scrollHeight===0){n.style.height=u;return}n.style.height=r+"px",s=n.clientWidth,t&&(document.documentElement.scrollTop=t)}function t(){var r;e();var f=Math.round(parseFloat(n.style.height)),t=window.getComputedStyle(n,null),i=t.boxSizing==="content-box"?Math.round(parseFloat(t.height)):n.offsetHeight;if(i!==f?t.overflowY==="hidden"&&(c("scroll"),e(),i=t.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight):t.overflowY!=="hidden"&&(c("hidden"),e(),i=t.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight),h!==i){h=i,r=u("autosize:resized");try{n.dispatchEvent(r)}catch(o){}}}var o,f;if(n&&n.nodeName&&n.nodeName==="TEXTAREA"&&!r.has(n)){var i=null,s=n.clientWidth,h=null;o=function(){n.clientWidth!==s&&t()},f=function(i){window.removeEventListener("resize",o,!1),n.removeEventListener("input",t,!1),n.removeEventListener("keyup",t,!1),n.removeEventListener("autosize:destroy",f,!1),n.removeEventListener("autosize:update",t,!1),Object.keys(i).forEach(function(t){n.style[t]=i[t]}),r["delete"](n)}.bind(n,{height:n.style.height,resize:n.style.resize,overflowY:n.style.overflowY,overflowX:n.style.overflowX,wordWrap:n.style.wordWrap}),n.addEventListener("autosize:destroy",f,!1),"onpropertychange"in n&&"oninput"in n&&n.addEventListener("keyup",t,!1),window.addEventListener("resize",o,!1),n.addEventListener("input",t,!1),n.addEventListener("autosize:update",t,!1),n.style.overflowX="hidden",n.style.wordWrap="break-word",r.set(n,{destroy:f,update:t}),l()}}function e(n){var t=r.get(n);t&&t.destroy()}function o(n){var t=r.get(n);t&&t.update()}var r=typeof Map=="function"?new Map:function(){var n=[],t=[];return{has:function(t){return n.indexOf(t)>-1},get:function(i){return t[n.indexOf(i)]},set:function(i,r){n.indexOf(i)===-1&&(n.push(i),t.push(r))},"delete":function(i){var r=n.indexOf(i);r>-1&&(n.splice(r,1),t.splice(r,1))}}}(),u=function(n){return new Event(n,{bubbles:!0})},i;try{new Event("test")}catch(s){u=function(n){var t=document.createEvent("Event");return t.initEvent(n,!0,!1),t}}i=null,typeof window=="undefined"||typeof window.getComputedStyle!="function"?(i=function(n){return n},i.destroy=function(n){return n},i.update=function(n){return n}):(i=function(n,t){return n&&Array.prototype.forEach.call(n.length?n:[n],function(n){return f(n,t)}),n},i.destroy=function(n){return n&&Array.prototype.forEach.call(n.length?n:[n],e),n},i.update=function(n){return n&&Array.prototype.forEach.call(n.length?n:[n],o),n}),t.exports=i}),function(n,t,i){function v(t,i){var u,f;if(n.isArray(t)){for(u=t.length-1;u>=0;u--)f=t[u],n.type(f)==="string"&&r.transports[f]||(i.log("Invalid transport: "+f+", removing it from the transports list."),t.splice(u,1));t.length===0&&(i.log("No transports remain within the specified transport array."),t=null)}else if(r.transports[t]||t==="auto"){if(t==="auto"&&r._.ieVersion<=8)return["longPolling"]}else i.log("Invalid transport: "+t.toString()+"."),t=null;return t}function y(n){return n==="http:"?80:n==="https:"?443:void 0}function h(n,t){return t.match(/:\d+$/)?t:t+":"+y(n)}function p(t,i){var u=this,r=[];u.tryBuffer=function(i){return t.state===n.signalR.connectionState.connecting?(r.push(i),!0):!1},u.drain=function(){if(t.state===n.signalR.connectionState.connected)while(r.length>0)i(r.shift())},u.clear=function(){r=[]}}var f={nojQuery:"jQuery was not found. Please ensure jQuery is referenced before the SignalR client JavaScript file.",noTransportOnInit:"No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.",errorOnNegotiate:"Error during negotiation request.",stoppedWhileLoading:"The connection was stopped during page load.",stoppedWhileNegotiating:"The connection was stopped during the negotiate request.",errorParsingNegotiateResponse:"Error parsing negotiate response.",errorDuringStartRequest:"Error during start request. Stopping the connection.",stoppedDuringStartRequest:"The connection was stopped during the start request.",errorParsingStartResponse:"Error parsing start response: '{0}'. Stopping the connection.",invalidStartResponse:"Invalid start response: '{0}'. Stopping the connection.",protocolIncompatible:"You are using a version of the client that isn't compatible with the server. Client version {0}, server version {1}.",sendFailed:"Send failed.",parseFailed:"Failed at parsing response: {0}",longPollFailed:"Long polling request failed.",eventSourceFailedToConnect:"EventSource failed to connect.",eventSourceError:"Error raised by EventSource",webSocketClosed:"WebSocket closed.",pingServerFailedInvalidResponse:"Invalid ping response when pinging server: '{0}'.",pingServerFailed:"Failed to ping server.",pingServerFailedStatusCode:"Failed to ping server.  Server responded with status code {0}, stopping the connection.",pingServerFailedParse:"Failed to parse ping server response, stopping the connection.",noConnectionTransport:"Connection is in an invalid state, there is no transport active.",webSocketsInvalidState:"The Web Socket transport is in an invalid state, transitioning into reconnecting.",reconnectTimeout:"Couldn't reconnect within the configured timeout of {0} ms, disconnecting.",reconnectWindowTimeout:"The client has been inactive since {0} and it has exceeded the inactivity timeout of {1} ms. Stopping the connection."};if(typeof n!="function")throw new Error(f.nojQuery);var r,c,o=t.document.readyState==="complete",e=n(t),l="__Negotiate Aborted__",u={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},w=function(n,i){if(i!==!1){var r;typeof t.console!="undefined"&&(r="["+(new Date).toTimeString()+"] SignalR: "+n,t.console.debug?t.console.debug(r):t.console.log&&t.console.log(r))}},s=function(t,i,r){return i===t.state?(t.state=r,n(t).triggerHandler(u.onStateChanged,[{oldState:i,newState:r}]),!0):!1},b=function(n){return n.state===r.connectionState.disconnected},a=function(n){return n._.keepAliveData.activated&&n.transport.supportsKeepAlive(n)},k=function(i){var f,e;i._.configuredStopReconnectingTimeout||(e=function(t){var i=r._.format(r.resources.reconnectTimeout,t.disconnectTimeout);t.log(i),n(t).triggerHandler(u.onError,[r._.error(i,"TimeoutException")]),t.stop(!1,!1)},i.reconnecting(function(){var n=this;n.state===r.connectionState.reconnecting&&(f=t.setTimeout(function(){e(n)},n.disconnectTimeout))}),i.stateChanged(function(n){n.oldState===r.connectionState.reconnecting&&t.clearTimeout(f)}),i._.configuredStopReconnectingTimeout=!0)};if(r=function(n,t,i){return new r.fn.init(n,t,i)},r._={defaultContentType:"application/x-www-form-urlencoded; charset=UTF-8",ieVersion:function(){var i,n;return t.navigator.appName==="Microsoft Internet Explorer"&&(n=/MSIE ([0-9]+\.[0-9]+)/.exec(t.navigator.userAgent),n&&(i=t.parseFloat(n[1]))),i}(),error:function(n,t,i){var r=new Error(n);return r.source=t,typeof i!="undefined"&&(r.context=i),r},transportError:function(n,t,r,u){var f=this.error(n,r,u);return f.transport=t?t.name:i,f},format:function(){for(var t=arguments[0],n=0;n<arguments.length-1;n++)t=t.replace("{"+n+"}",arguments[n+1]);return t},firefoxMajorVersion:function(n){var t=n.match(/Firefox\/(\d+)/);return!t||!t.length||t.length<2?0:parseInt(t[1],10)},configurePingInterval:function(i){var f=i._.config,e=function(t){n(i).triggerHandler(u.onError,[t])};f&&!i._.pingIntervalId&&f.pingInterval&&(i._.pingIntervalId=t.setInterval(function(){r.transports._logic.pingServer(i).fail(e)},f.pingInterval))}},r.events=u,r.resources=f,r.ajaxDefaults={processData:!0,timeout:null,async:!0,global:!1,cache:!1},r.changeState=s,r.isDisconnecting=b,r.connectionState={connecting:0,connected:1,reconnecting:2,disconnected:4},r.hub={start:function(){throw new Error("SignalR: Error loading hubs. Ensure your hubs reference is correct, e.g. <script src='/signalr/js'><\/script>.");}},typeof e.on=="function")e.on("load",function(){o=!0});else e.load(function(){o=!0});r.fn=r.prototype={init:function(t,i,r){var f=n(this);this.url=t,this.qs=i,this.lastError=null,this._={keepAliveData:{},connectingMessageBuffer:new p(this,function(n){f.triggerHandler(u.onReceived,[n])}),lastMessageAt:+new Date,lastActiveAt:+new Date,beatInterval:5e3,beatHandle:null,totalTransportConnectTimeout:0},typeof r=="boolean"&&(this.logging=r)},_parseResponse:function(n){var t=this;return n?typeof n=="string"?t.json.parse(n):n:n},_originalJson:t.JSON,json:t.JSON,isCrossDomain:function(i,r){var u;return(i=n.trim(i),r=r||t.location,i.indexOf("http")!==0)?!1:(u=t.document.createElement("a"),u.href=i,u.protocol+h(u.protocol,u.host)!==r.protocol+h(r.protocol,r.host))},ajaxDataType:"text",contentType:"application/json; charset=UTF-8",logging:!1,state:r.connectionState.disconnected,clientProtocol:"1.5",reconnectDelay:2e3,transportConnectTimeout:0,disconnectTimeout:3e4,reconnectWindow:3e4,keepAliveWarnAt:2/3,start:function(i,h){var c=this,y={pingInterval:3e5,waitForPageLoad:!0,transport:"auto",jsonp:!1},d,p=c._deferral||n.Deferred(),w=t.document.createElement("a"),b,g;if(c.lastError=null,c._deferral=p,!c.json)throw new Error("SignalR: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.");if(n.type(i)==="function"?h=i:n.type(i)==="object"&&(n.extend(y,i),n.type(y.callback)==="function"&&(h=y.callback)),y.transport=v(y.transport,c),!y.transport)throw new Error("SignalR: Invalid transport(s) specified, aborting start.");return(c._.config=y,!o&&y.waitForPageLoad===!0)?(c._.deferredStartHandler=function(){c.start(i,h)},e.bind("load",c._.deferredStartHandler),p.promise()):c.state===r.connectionState.connecting?p.promise():s(c,r.connectionState.disconnected,r.connectionState.connecting)===!1?(p.resolve(c),p.promise()):(k(c),w.href=c.url,w.protocol&&w.protocol!==":"?(c.protocol=w.protocol,c.host=w.host):(c.protocol=t.document.location.protocol,c.host=w.host||t.document.location.host),c.baseUrl=c.protocol+"//"+c.host,c.wsProtocol=c.protocol==="https:"?"wss://":"ws://",y.transport==="auto"&&y.jsonp===!0&&(y.transport="longPolling"),c.url.indexOf("//")===0&&(c.url=t.location.protocol+c.url,c.log("Protocol relative URL detected, normalizing it to '"+c.url+"'.")),this.isCrossDomain(c.url)&&(c.log("Auto detected cross domain url."),y.transport==="auto"&&(y.transport=["webSockets","serverSentEvents","longPolling"]),typeof y.withCredentials=="undefined"&&(y.withCredentials=!0),y.jsonp||(y.jsonp=!n.support.cors,y.jsonp&&c.log("Using jsonp because this browser doesn't support CORS.")),c.contentType=r._.defaultContentType),c.withCredentials=y.withCredentials,c.ajaxDataType=y.jsonp?"jsonp":"text",n(c).bind(u.onStart,function(){n.type(h)==="function"&&h.call(c),p.resolve(c)}),c._.initHandler=r.transports._logic.initHandler(c),d=function(i,o){var l=r._.error(f.noTransportOnInit);if(o=o||0,o>=i.length){o===0?c.log("No transports supported by the server were selected."):o===1?c.log("No fallback transports were selected."):c.log("Fallback transports exhausted."),n(c).triggerHandler(u.onError,[l]),p.reject(l),c.stop();return}if(c.state!==r.connectionState.disconnected){var y=i[o],h=r.transports[y],v=function(){d(i,o+1)};c.transport=h;try{c._.initHandler.start(h,function(){var i=r._.firefoxMajorVersion(t.navigator.userAgent)>=11,f=!!c.withCredentials&&i;c.log("The start request succeeded. Transitioning to the connected state."),a(c)&&r.transports._logic.monitorKeepAlive(c),r.transports._logic.startHeartbeat(c),r._.configurePingInterval(c),s(c,r.connectionState.connecting,r.connectionState.connected)||c.log("WARNING! The connection was not in the connecting state."),c._.connectingMessageBuffer.drain(),n(c).triggerHandler(u.onStart),e.bind("unload",function(){c.log("Window unloading, stopping the connection."),c.stop(f)}),i&&e.bind("beforeunload",function(){t.setTimeout(function(){c.stop(f)},0)})},v)}catch(w){c.log(h.name+" transport threw '"+w.message+"' when attempting to start."),v()}}},b=c.url+"/negotiate",g=function(t,i){var e=r._.error(f.errorOnNegotiate,t,i._.negotiateRequest);n(i).triggerHandler(u.onError,e),p.reject(e),i.stop()},n(c).triggerHandler(u.onStarting),b=r.transports._logic.prepareQueryString(c,b),c.log("Negotiating with '"+b+"'."),c._.negotiateRequest=r.transports._logic.ajax(c,{url:b,error:function(n,t){t!==l?g(n,c):p.reject(r._.error(f.stoppedWhileNegotiating,null,c._.negotiateRequest))},success:function(t){var i,e,h,o=[],s=[];try{i=c._parseResponse(t)}catch(l){g(r._.error(f.errorParsingNegotiateResponse,l),c);return}if(e=c._.keepAliveData,c.appRelativeUrl=i.Url,c.id=i.ConnectionId,c.token=i.ConnectionToken,c.webSocketServerUrl=i.WebSocketServerUrl,c._.pollTimeout=i.ConnectionTimeout*1e3+1e4,c.disconnectTimeout=i.DisconnectTimeout*1e3,c._.totalTransportConnectTimeout=c.transportConnectTimeout+i.TransportConnectTimeout*1e3,i.KeepAliveTimeout?(e.activated=!0,e.timeout=i.KeepAliveTimeout*1e3,e.timeoutWarning=e.timeout*c.keepAliveWarnAt,c._.beatInterval=(e.timeout-e.timeoutWarning)/3):e.activated=!1,c.reconnectWindow=c.disconnectTimeout+(e.timeout||0),!i.ProtocolVersion||i.ProtocolVersion!==c.clientProtocol){h=r._.error(r._.format(f.protocolIncompatible,c.clientProtocol,i.ProtocolVersion)),n(c).triggerHandler(u.onError,[h]),p.reject(h);return}n.each(r.transports,function(n){if(n.indexOf("_")===0||n==="webSockets"&&!i.TryWebSockets)return!0;s.push(n)}),n.isArray(y.transport)?n.each(y.transport,function(t,i){n.inArray(i,s)>=0&&o.push(i)}):y.transport==="auto"?o=s:n.inArray(y.transport,s)>=0&&o.push(y.transport),d(o)}}),p.promise())},starting:function(t){var i=this;return n(i).bind(u.onStarting,function(){t.call(i)}),i},send:function(n){var t=this;if(t.state===r.connectionState.disconnected)throw new Error("SignalR: Connection must be started before data can be sent. Call .start() before .send()");if(t.state===r.connectionState.connecting)throw new Error("SignalR: Connection has not been fully initialized. Use .start().done() or .start().fail() to run logic after the connection has started.");return t.transport.send(t,n),t},received:function(t){var i=this;return n(i).bind(u.onReceived,function(n,r){t.call(i,r)}),i},stateChanged:function(t){var i=this;return n(i).bind(u.onStateChanged,function(n,r){t.call(i,r)}),i},error:function(t){var i=this;return n(i).bind(u.onError,function(n,r,u){i.lastError=r,t.call(i,r,u)}),i},disconnected:function(t){var i=this;return n(i).bind(u.onDisconnect,function(){t.call(i)}),i},connectionSlow:function(t){var i=this;return n(i).bind(u.onConnectionSlow,function(){t.call(i)}),i},reconnecting:function(t){var i=this;return n(i).bind(u.onReconnecting,function(){t.call(i)}),i},reconnected:function(t){var i=this;return n(i).bind(u.onReconnect,function(){t.call(i)}),i},stop:function(i,h){var c=this,v=c._deferral;if(c._.deferredStartHandler&&e.unbind("load",c._.deferredStartHandler),delete c._.config,delete c._.deferredStartHandler,!o&&(!c._.config||c._.config.waitForPageLoad===!0)){c.log("Stopping connection prior to negotiate."),v&&v.reject(r._.error(f.stoppedWhileLoading));return}if(c.state!==r.connectionState.disconnected)return c.log("Stopping connection."),t.clearTimeout(c._.beatHandle),t.clearInterval(c._.pingIntervalId),c.transport&&(c.transport.stop(c),h!==!1&&c.transport.abort(c,i),a(c)&&r.transports._logic.stopMonitoringKeepAlive(c),c.transport=null),c._.negotiateRequest&&(c._.negotiateRequest.abort(l),delete c._.negotiateRequest),c._.initHandler&&c._.initHandler.stop(),delete c._deferral,delete c.messageId,delete c.groupsToken,delete c.id,delete c._.pingIntervalId,delete c._.lastMessageAt,delete c._.lastActiveAt,c._.connectingMessageBuffer.clear(),s(c,c.state,r.connectionState.disconnected),n(c).triggerHandler(u.onDisconnect),c},log:function(n){w(n,this.logging)}},r.fn.init.prototype=r.fn,r.noConflict=function(){return n.connection===r&&(n.connection=c),r},n.connection&&(c=n.connection),n.connection=n.signalR=r}(window.jQuery,window),function(n,t,i){function o(n){n._.keepAliveData.monitoring&&c(n),u.markActive(n)&&(n._.beatHandle=t.setTimeout(function(){o(n)},n._.beatInterval))}function c(t){var i=t._.keepAliveData,u;t.state===r.connectionState.connected&&(u=+new Date-t._.lastMessageAt,u>=i.timeout?(t.log("Keep alive timed out.  Notifying transport that connection has been lost."),t.transport.lostConnection(t)):u>=i.timeoutWarning?i.userNotified||(t.log("Keep alive has been missed, connection may be dead/slow."),n(t).triggerHandler(f.onConnectionSlow),i.userNotified=!0):i.userNotified=!1)}function e(n,t){var i=n.url+t;return n.transport&&(i+="?transport="+n.transport.name),u.prepareQueryString(n,i)}function s(n){this.connection=n,this.startRequested=!1,this.startCompleted=!1,this.connectionStopped=!1}var r=n.signalR,f=n.signalR.events,l=n.signalR.changeState,h="__Start Aborted__",u;r.transports={},s.prototype={start:function(n,r,u){var f=this,e=f.connection,o=!1;if(f.startRequested||f.connectionStopped){e.log("WARNING! "+n.name+" transport cannot be started. Initialization ongoing or completed.");return}e.log(n.name+" transport starting."),n.start(e,function(){o||f.initReceived(n,r)},function(t){return o||(o=!0,f.transportFailed(n,t,u)),!f.startCompleted||f.connectionStopped}),f.transportTimeoutHandle=t.setTimeout(function(){o||(o=!0,e.log(n.name+" transport timed out when trying to connect."),f.transportFailed(n,i,u))},e._.totalTransportConnectTimeout)},stop:function(){this.connectionStopped=!0,t.clearTimeout(this.transportTimeoutHandle),r.transports._logic.tryAbortStartRequest(this.connection)},initReceived:function(n,i){var u=this,f=u.connection;if(u.startRequested){f.log("WARNING! The client received multiple init messages.");return}u.connectionStopped||(u.startRequested=!0,t.clearTimeout(u.transportTimeoutHandle),f.log(n.name+" transport connected. Initiating start request."),r.transports._logic.ajaxStart(f,function(){u.startCompleted=!0,i()}))},transportFailed:function(i,u,e){var o=this.connection,h=o._deferral,s;this.connectionStopped||(t.clearTimeout(this.transportTimeoutHandle),this.startRequested?this.startCompleted||(s=r._.error(r.resources.errorDuringStartRequest,u),o.log(i.name+" transport failed during the start request. Stopping the connection."),n(o).triggerHandler(f.onError,[s]),h&&h.reject(s),o.stop()):(i.stop(o),o.log(i.name+" transport failed to connect. Attempting to fall back."),e()))}},u=r.transports._logic={ajax:function(t,i){return n.ajax(n.extend(!0,{},n.signalR.ajaxDefaults,{type:"GET",data:{},xhrFields:{withCredentials:t.withCredentials},contentType:t.contentType,dataType:t.ajaxDataType},i))},pingServer:function(t){var e,f,i=n.Deferred();return t.transport?(e=t.url+"/ping",e=u.addQs(e,t.qs),f=u.ajax(t,{url:e,success:function(n){var u;try{u=t._parseResponse(n)}catch(e){i.reject(r._.transportError(r.resources.pingServerFailedParse,t.transport,e,f)),t.stop();return}u.Response==="pong"?i.resolve():i.reject(r._.transportError(r._.format(r.resources.pingServerFailedInvalidResponse,n),t.transport,null,f))},error:function(n){n.status===401||n.status===403?(i.reject(r._.transportError(r._.format(r.resources.pingServerFailedStatusCode,n.status),t.transport,n,f)),t.stop()):i.reject(r._.transportError(r.resources.pingServerFailed,t.transport,n,f))}})):i.reject(r._.transportError(r.resources.noConnectionTransport,t.transport)),i.promise()},prepareQueryString:function(n,i){var r;return r=u.addQs(i,"clientProtocol="+n.clientProtocol),r=u.addQs(r,n.qs),n.token&&(r+="&connectionToken="+t.encodeURIComponent(n.token)),n.data&&(r+="&connectionData="+t.encodeURIComponent(n.data)),r},addQs:function(t,i){var r=t.indexOf("?")!==-1?"&":"?",u;if(!i)return t;if(typeof i=="object")return t+r+n.param(i);if(typeof i=="string")return u=i.charAt(0),(u==="?"||u==="&")&&(r=""),t+r+i;throw new Error("Query string property must be either a string or object.");},getUrl:function(n,i,r,f,e){var h=i==="webSockets"?"":n.baseUrl,o=h+n.appRelativeUrl,s="transport="+i;return!e&&n.groupsToken&&(s+="&groupsToken="+t.encodeURIComponent(n.groupsToken)),r?(o+=f?"/poll":"/reconnect",!e&&n.messageId&&(s+="&messageId="+t.encodeURIComponent(n.messageId))):o+="/connect",o+="?"+s,o=u.prepareQueryString(n,o),e||(o+="&tid="+Math.floor(Math.random()*11)),o},maximizePersistentResponse:function(n){return{MessageId:n.C,Messages:n.M,Initialized:typeof n.S!="undefined"?!0:!1,ShouldReconnect:typeof n.T!="undefined"?!0:!1,LongPollDelay:n.L,GroupsToken:n.G}},updateGroups:function(n,t){t&&(n.groupsToken=t)},stringifySend:function(n,t){return typeof t=="string"||typeof t=="undefined"||t===null?t:n.json.stringify(t)},ajaxSend:function(t,i){var h=u.stringifySend(t,i),c=e(t,"/send"),o,s=function(t,u){n(u).triggerHandler(f.onError,[r._.transportError(r.resources.sendFailed,u.transport,t,o),i])};return o=u.ajax(t,{url:c,type:t.ajaxDataType==="jsonp"?"GET":"POST",contentType:r._.defaultContentType,data:{data:h},success:function(n){var i;if(n){try{i=t._parseResponse(n)}catch(r){s(r,t),t.stop();return}u.triggerReceived(t,i)}},error:function(n,i){i!=="abort"&&i!=="parsererror"&&s(n,t)}})},ajaxAbort:function(n,t){if(typeof n.transport!="undefined"){t=typeof t=="undefined"?!0:t;var i=e(n,"/abort");u.ajax(n,{url:i,async:t,timeout:1e3,type:"POST"}),n.log("Fired ajax abort async = "+t+".")}},ajaxStart:function(t,i){var s=function(n){var i=t._deferral;i&&i.reject(n)},o=function(i){t.log("The start request failed. Stopping the connection."),n(t).triggerHandler(f.onError,[i]),s(i),t.stop()};t._.startRequest=u.ajax(t,{url:e(t,"/start"),success:function(n,u,f){var e;try{e=t._parseResponse(n)}catch(s){o(r._.error(r._.format(r.resources.errorParsingStartResponse,n),s,f));return}e.Response==="started"?i():o(r._.error(r._.format(r.resources.invalidStartResponse,n),null,f))},error:function(n,i,u){i!==h?o(r._.error(r.resources.errorDuringStartRequest,u,n)):(t.log("The start request aborted because connection.stop() was called."),s(r._.error(r.resources.stoppedDuringStartRequest,null,n)))}})},tryAbortStartRequest:function(n){n._.startRequest&&(n._.startRequest.abort(h),delete n._.startRequest)},tryInitialize:function(n,t,i){t.Initialized&&i?i():t.Initialized&&n.log("WARNING! The client received an init message after reconnecting.")},triggerReceived:function(t,i){t._.connectingMessageBuffer.tryBuffer(i)||n(t).triggerHandler(f.onReceived,[i])},processMessages:function(t,i,r){var f;u.markLastMessage(t),i&&(f=u.maximizePersistentResponse(i),u.updateGroups(t,f.GroupsToken),f.MessageId&&(t.messageId=f.MessageId),f.Messages&&(n.each(f.Messages,function(n,i){u.triggerReceived(t,i)}),u.tryInitialize(t,f,r)))},monitorKeepAlive:function(t){var i=t._.keepAliveData;i.monitoring?t.log("Tried to monitor keep alive but it's already being monitored."):(i.monitoring=!0,u.markLastMessage(t),t._.keepAliveData.reconnectKeepAliveUpdate=function(){u.markLastMessage(t)},n(t).bind(f.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t.log("Now monitoring keep alive with a warning timeout of "+i.timeoutWarning+", keep alive timeout of "+i.timeout+" and disconnecting timeout of "+t.disconnectTimeout))},stopMonitoringKeepAlive:function(t){var i=t._.keepAliveData;i.monitoring&&(i.monitoring=!1,n(t).unbind(f.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t._.keepAliveData={},t.log("Stopping the monitoring of the keep alive."))},startHeartbeat:function(n){n._.lastActiveAt=+new Date,o(n)},markLastMessage:function(n){n._.lastMessageAt=+new Date},markActive:function(n){return u.verifyLastActive(n)?(n._.lastActiveAt=+new Date,!0):!1},isConnectedOrReconnecting:function(n){return n.state===r.connectionState.connected||n.state===r.connectionState.reconnecting},ensureReconnectingState:function(t){return l(t,r.connectionState.connected,r.connectionState.reconnecting)===!0&&n(t).triggerHandler(f.onReconnecting),t.state===r.connectionState.reconnecting},clearReconnectTimeout:function(n){n&&n._.reconnectTimeout&&(t.clearTimeout(n._.reconnectTimeout),delete n._.reconnectTimeout)},verifyLastActive:function(t){if(+new Date-t._.lastActiveAt>=t.reconnectWindow){var i=r._.format(r.resources.reconnectWindowTimeout,new Date(t._.lastActiveAt),t.reconnectWindow);return t.log(i),n(t).triggerHandler(f.onError,[r._.error(i,"TimeoutException")]),t.stop(!1,!1),!1}return!0},reconnect:function(n,i){var f=r.transports[i];if(u.isConnectedOrReconnecting(n)&&!n._.reconnectTimeout){if(!u.verifyLastActive(n))return;n._.reconnectTimeout=t.setTimeout(function(){u.verifyLastActive(n)&&(f.stop(n),u.ensureReconnectingState(n)&&(n.log(i+" reconnecting."),f.start(n)))},n.reconnectDelay)}},handleParseFailure:function(t,i,u,e,o){var s=r._.transportError(r._.format(r.resources.parseFailed,i),t.transport,u,o);e&&e(s)?t.log("Failed to parse server response while attempting to connect."):(n(t).triggerHandler(f.onError,[s]),t.stop())},initHandler:function(n){return new s(n)},foreverFrame:{count:0,connections:{}}}}(window.jQuery,window),function(n,t){var r=n.signalR,u=n.signalR.events,f=n.signalR.changeState,i=r.transports._logic;r.transports.webSockets={name:"webSockets",supportsKeepAlive:function(){return!0},send:function(t,f){var e=i.stringifySend(t,f);try{t.socket.send(e)}catch(o){n(t).triggerHandler(u.onError,[r._.transportError(r.resources.webSocketsInvalidState,t.transport,o,t.socket),f])}},start:function(e,o,s){var h,c=!1,l=this,a=!o,v=n(e);if(!t.WebSocket){s();return}e.socket||(h=e.webSocketServerUrl?e.webSocketServerUrl:e.wsProtocol+e.host,h+=i.getUrl(e,this.name,a),e.log("Connecting to websocket endpoint '"+h+"'."),e.socket=new t.WebSocket(h),e.socket.onopen=function(){c=!0,e.log("Websocket opened."),i.clearReconnectTimeout(e),f(e,r.connectionState.reconnecting,r.connectionState.connected)===!0&&v.triggerHandler(u.onReconnect)},e.socket.onclose=function(t){var i;this===e.socket&&(c&&typeof t.wasClean!="undefined"&&t.wasClean===!1?(i=r._.transportError(r.resources.webSocketClosed,e.transport,t),e.log("Unclean disconnect from websocket: "+(t.reason||"[no reason given]."))):e.log("Websocket closed."),s&&s(i)||(i&&n(e).triggerHandler(u.onError,[i]),l.reconnect(e)))},e.socket.onmessage=function(t){var r;try{r=e._parseResponse(t.data)}catch(u){i.handleParseFailure(e,t.data,u,s,t);return}r&&(n.isEmptyObject(r)||r.M?i.processMessages(e,r,o):i.triggerReceived(e,r))})},reconnect:function(n){i.reconnect(n,this.name)},lostConnection:function(n){this.reconnect(n)},stop:function(n){i.clearReconnectTimeout(n),n.socket&&(n.log("Closing the Websocket."),n.socket.close(),n.socket=null)},abort:function(n,t){i.ajaxAbort(n,t)}}}(window.jQuery,window),function(n,t){var i=n.signalR,u=n.signalR.events,e=n.signalR.changeState,r=i.transports._logic,f=function(n){t.clearTimeout(n._.reconnectAttemptTimeoutHandle),delete n._.reconnectAttemptTimeoutHandle};i.transports.serverSentEvents={name:"serverSentEvents",supportsKeepAlive:function(){return!0},timeOut:3e3,start:function(o,s,h){var c=this,l=!1,a=n(o),v=!s,y;if(o.eventSource&&(o.log("The connection already has an event source. Stopping it."),o.stop()),!t.EventSource){h&&(o.log("This browser doesn't support SSE."),h());return}y=r.getUrl(o,this.name,v);try{o.log("Attempting to connect to SSE endpoint '"+y+"'."),o.eventSource=new t.EventSource(y,{withCredentials:o.withCredentials})}catch(p){o.log("EventSource failed trying to connect with error "+p.Message+"."),h?h():(a.triggerHandler(u.onError,[i._.transportError(i.resources.eventSourceFailedToConnect,o.transport,p)]),v&&c.reconnect(o));return}v&&(o._.reconnectAttemptTimeoutHandle=t.setTimeout(function(){l===!1&&o.eventSource.readyState!==t.EventSource.OPEN&&c.reconnect(o)},c.timeOut)),o.eventSource.addEventListener("open",function(){o.log("EventSource connected."),f(o),r.clearReconnectTimeout(o),l===!1&&(l=!0,e(o,i.connectionState.reconnecting,i.connectionState.connected)===!0&&a.triggerHandler(u.onReconnect))},!1),o.eventSource.addEventListener("message",function(n){var t;if(n.data!=="initialized"){try{t=o._parseResponse(n.data)}catch(i){r.handleParseFailure(o,n.data,i,h,n);return}r.processMessages(o,t,s)}},!1),o.eventSource.addEventListener("error",function(n){var r=i._.transportError(i.resources.eventSourceError,o.transport,n);this===o.eventSource&&(h&&h(r)||(o.log("EventSource readyState: "+o.eventSource.readyState+"."),n.eventPhase===t.EventSource.CLOSED?(o.log("EventSource reconnecting due to the server connection ending."),c.reconnect(o)):(o.log("EventSource error."),a.triggerHandler(u.onError,[r]))))},!1)},reconnect:function(n){r.reconnect(n,this.name)},lostConnection:function(n){this.reconnect(n)},send:function(n,t){r.ajaxSend(n,t)},stop:function(n){f(n),r.clearReconnectTimeout(n),n&&n.eventSource&&(n.log("EventSource calling close()."),n.eventSource.close(),n.eventSource=null,delete n.eventSource)},abort:function(n,t){r.ajaxAbort(n,t)}}}(window.jQuery,window),function(n,t){var r=n.signalR,e=n.signalR.events,o=n.signalR.changeState,i=r.transports._logic,u=function(){var n=t.document.createElement("iframe");return n.setAttribute("style","position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;"),n},f=function(){var i=null,f=1e3,n=0;return{prevent:function(){r._.ieVersion<=8&&(n===0&&(i=t.setInterval(function(){var n=u();t.document.body.appendChild(n),t.document.body.removeChild(n),n=null},f)),n++)},cancel:function(){n===1&&t.clearInterval(i),n>0&&n--}}}();r.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:function(){return!0},iframeClearThreshold:50,start:function(n,r,e){var l=this,s=i.foreverFrame.count+=1,h,o=u(),c=function(){n.log("Forever frame iframe finished loading and is no longer receiving messages."),e&&e()||l.reconnect(n)};if(t.EventSource){e&&(n.log("Forever Frame is not supported by SignalR on browsers with SSE support."),e());return}o.setAttribute("data-signalr-connection-id",n.id),f.prevent(),h=i.getUrl(n,this.name),h+="&frameId="+s,t.document.documentElement.appendChild(o),n.log("Binding to iframe's load event."),o.addEventListener?o.addEventListener("load",c,!1):o.attachEvent&&o.attachEvent("onload",c),o.src=h,i.foreverFrame.connections[s]=n,n.frame=o,n.frameId=s,r&&(n.onSuccess=function(){n.log("Iframe transport started."),r()})},reconnect:function(n){var r=this;i.isConnectedOrReconnecting(n)&&i.verifyLastActive(n)&&t.setTimeout(function(){if(i.verifyLastActive(n)&&n.frame&&i.ensureReconnectingState(n)){var u=n.frame,t=i.getUrl(n,r.name,!0)+"&frameId="+n.frameId;n.log("Updating iframe src to '"+t+"'."),u.src=t}},n.reconnectDelay)},lostConnection:function(n){this.reconnect(n)},send:function(n,t){i.ajaxSend(n,t)},receive:function(t,u){var f,e,o;if(t.json!==t._originalJson&&(u=t._originalJson.stringify(u)),o=t._parseResponse(u),i.processMessages(t,o,t.onSuccess),t.state===n.signalR.connectionState.connected&&(t.frameMessageCount=(t.frameMessageCount||0)+1,t.frameMessageCount>r.transports.foreverFrame.iframeClearThreshold&&(t.frameMessageCount=0,f=t.frame.contentWindow||t.frame.contentDocument,f&&f.document&&f.document.body)))for(e=f.document.body;e.firstChild;)e.removeChild(e.firstChild)},stop:function(n){var r=null;if(f.cancel(),n.frame){if(n.frame.stop)n.frame.stop();else try{r=n.frame.contentWindow||n.frame.contentDocument,r.document&&r.document.execCommand&&r.document.execCommand("Stop")}catch(u){n.log("Error occurred when stopping foreverFrame transport. Message = "+u.message+".")}n.frame.parentNode===t.document.body&&t.document.body.removeChild(n.frame),delete i.foreverFrame.connections[n.frameId],n.frame=null,n.frameId=null,delete n.frame,delete n.frameId,delete n.onSuccess,delete n.frameMessageCount,n.log("Stopping forever frame.")}},abort:function(n,t){i.ajaxAbort(n,t)},getConnection:function(n){return i.foreverFrame.connections[n]},started:function(t){o(t,r.connectionState.reconnecting,r.connectionState.connected)===!0&&n(t).triggerHandler(e.onReconnect)}}}(window.jQuery,window),function(n,t){var r=n.signalR,u=n.signalR.events,e=n.signalR.changeState,f=n.signalR.isDisconnecting,i=r.transports._logic;r.transports.longPolling={name:"longPolling",supportsKeepAlive:function(){return!1},reconnectDelay:3e3,start:function(o,s,h){var a=this,v=function(){v=n.noop,o.log("LongPolling connected."),s?s():o.log("WARNING! The client received an init message after reconnecting.")},y=function(n){return h(n)?(o.log("LongPolling failed to connect."),!0):!1},c=o._,l=0,p=function(i){t.clearTimeout(c.reconnectTimeoutId),c.reconnectTimeoutId=null,e(i,r.connectionState.reconnecting,r.connectionState.connected)===!0&&(i.log("Raising the reconnect event"),n(i).triggerHandler(u.onReconnect))},w=36e5;o.pollXhr&&(o.log("Polling xhr requests already exists, aborting."),o.stop()),o.messageId=null,c.reconnectTimeoutId=null,c.pollTimeoutId=t.setTimeout(function(){(function e(s,h){var g=s.messageId,nt=g===null,k=!nt,tt=!h,d=i.getUrl(s,a.name,k,tt,!0),b={};(s.messageId&&(b.messageId=s.messageId),s.groupsToken&&(b.groupsToken=s.groupsToken),f(s)!==!0)&&(o.log("Opening long polling request to '"+d+"'."),s.pollXhr=i.ajax(o,{xhrFields:{onprogress:function(){i.markLastMessage(o)}},url:d,type:"POST",contentType:r._.defaultContentType,data:b,timeout:o._.pollTimeout,success:function(r){var h,w=0,u,a;o.log("Long poll complete."),l=0;try{h=o._parseResponse(r)}catch(b){i.handleParseFailure(s,r,b,y,s.pollXhr);return}(c.reconnectTimeoutId!==null&&p(s),h&&(u=i.maximizePersistentResponse(h)),i.processMessages(s,h,v),u&&n.type(u.LongPollDelay)==="number"&&(w=u.LongPollDelay),f(s)!==!0)&&(a=u&&u.ShouldReconnect,!a||i.ensureReconnectingState(s))&&(w>0?c.pollTimeoutId=t.setTimeout(function(){e(s,a)},w):e(s,a))},error:function(f,h){var v=r._.transportError(r.resources.longPollFailed,o.transport,f,s.pollXhr);if(t.clearTimeout(c.reconnectTimeoutId),c.reconnectTimeoutId=null,h==="abort"){o.log("Aborted xhr request.");return}if(!y(v)){if(l++,o.state!==r.connectionState.reconnecting&&(o.log("An error occurred using longPolling. Status = "+h+".  Response = "+f.responseText+"."),n(s).triggerHandler(u.onError,[v])),(o.state===r.connectionState.connected||o.state===r.connectionState.reconnecting)&&!i.verifyLastActive(o))return;if(!i.ensureReconnectingState(s))return;c.pollTimeoutId=t.setTimeout(function(){e(s,!0)},a.reconnectDelay)}}}),k&&h===!0&&(c.reconnectTimeoutId=t.setTimeout(function(){p(s)},Math.min(1e3*(Math.pow(2,l)-1),w))))})(o)},250)},lostConnection:function(n){n.pollXhr&&n.pollXhr.abort("lostConnection")},send:function(n,t){i.ajaxSend(n,t)},stop:function(n){t.clearTimeout(n._.pollTimeoutId),t.clearTimeout(n._.reconnectTimeoutId),delete n._.pollTimeoutId,delete n._.reconnectTimeoutId,n.pollXhr&&(n.pollXhr.abort(),n.pollXhr=null,delete n.pollXhr)},abort:function(n,t){i.ajaxAbort(n,t)}}}(window.jQuery,window),function(n){function r(n){return n+s}function e(n,t,i){for(var f=n.length,u=[],r=0;r<f;r+=1)n.hasOwnProperty(r)&&(u[r]=t.call(i,n[r],r,n));return u}function o(t){return n.isFunction(t)?null:n.type(t)==="undefined"?null:t}function u(n){for(var t in n)if(n.hasOwnProperty(t))return!0;return!1}function f(n,t){var i=n._.invocationCallbacks,r,f;u(i)&&n.log("Clearing hub invocation callbacks with error: "+t+"."),n._.invocationCallbackId=0,delete n._.invocationCallbacks,n._.invocationCallbacks={};for(f in i)r=i[f],r.method.call(r.scope,{E:t})}function i(n,t){return new i.fn.init(n,t)}function t(i,r){var u={qs:null,logging:!1,useDefaultPath:!0};return n.extend(u,r),(!i||u.useDefaultPath)&&(i=(i||"")+"/signalr"),new t.fn.init(i,u)}var s=".hubProxy",h=n.signalR;i.fn=i.prototype={init:function(n,t){this.state={},this.connection=n,this.hubName=t,this._={callbackMap:{}}},constructor:i,hasSubscriptions:function(){return u(this._.callbackMap)},on:function(t,i){var u=this,f=u._.callbackMap;return t=t.toLowerCase(),f[t]||(f[t]={}),f[t][i]=function(n,t){i.apply(u,t)},n(u).bind(r(t),f[t][i]),u},off:function(t,i){var e=this,o=e._.callbackMap,f;return t=t.toLowerCase(),f=o[t],f&&(f[i]?(n(e).unbind(r(t),f[i]),delete f[i],u(f)||delete o[t]):i||(n(e).unbind(r(t)),delete o[t])),e},invoke:function(t){var i=this,r=i.connection,s=n.makeArray(arguments).slice(1),c=e(s,o),f={H:i.hubName,M:t,A:c,I:r._.invocationCallbackId},u=n.Deferred(),l=function(f){var e=i._maximizeHubResponse(f),s,o;n.extend(i.state,e.State),e.Progress?u.notifyWith?u.notifyWith(i,[e.Progress.Data]):r._.progressjQueryVersionLogged||(r.log("A hub method invocation progress update was received but the version of jQuery in use ("+n.prototype.jquery+") does not support progress updates. Upgrade to jQuery 1.7+ to receive progress notifications."),r._.progressjQueryVersionLogged=!0):e.Error?(e.StackTrace&&r.log(e.Error+"\n"+e.StackTrace+"."),s=e.IsHubException?"HubException":"Exception",o=h._.error(e.Error,s),o.data=e.ErrorData,r.log(i.hubName+"."+t+" failed to execute. Error: "+o.message),u.rejectWith(i,[o])):(r.log("Invoked "+i.hubName+"."+t),u.resolveWith(i,[e.Result]))};return r._.invocationCallbacks[r._.invocationCallbackId.toString()]={scope:i,method:l},r._.invocationCallbackId+=1,n.isEmptyObject(i.state)||(f.S=i.state),r.log("Invoking "+i.hubName+"."+t),r.send(f),u.promise()},_maximizeHubResponse:function(n){return{State:n.S,Result:n.R,Progress:n.P?{Id:n.P.I,Data:n.P.D}:null,Id:n.I,IsHubException:n.H,Error:n.E,StackTrace:n.T,ErrorData:n.D}}},i.fn.init.prototype=i.fn,t.fn=t.prototype=n.connection(),t.fn.init=function(t,i){var e={qs:null,logging:!1,useDefaultPath:!0},u=this;n.extend(e,i),n.signalR.fn.init.call(u,t,e.qs,e.logging),u.proxies={},u._.invocationCallbackId=0,u._.invocationCallbacks={},u.received(function(t){var f,o,e,i,s,h;t&&(typeof t.P!="undefined"?(e=t.P.I.toString(),i=u._.invocationCallbacks[e],i&&i.method.call(i.scope,t)):typeof t.I!="undefined"?(e=t.I.toString(),i=u._.invocationCallbacks[e],i&&(u._.invocationCallbacks[e]=null,delete u._.invocationCallbacks[e],i.method.call(i.scope,t))):(f=this._maximizeClientHubInvocation(t),u.log("Triggering client hub event '"+f.Method+"' on hub '"+f.Hub+"'."),s=f.Hub.toLowerCase(),h=f.Method.toLowerCase(),o=this.proxies[s],n.extend(o.state,f.State),n(o).triggerHandler(r(h),[f.Args])))}),u.error(function(n,t){var i,r;t&&(i=t.I,r=u._.invocationCallbacks[i],r&&(u._.invocationCallbacks[i]=null,delete u._.invocationCallbacks[i],r.method.call(r.scope,{E:n})))}),u.reconnecting(function(){u.transport&&u.transport.name==="webSockets"&&f(u,"Connection started reconnecting before invocation result was received.")}),u.disconnected(function(){f(u,"Connection was disconnected before invocation result was received.")})},t.fn._maximizeClientHubInvocation=function(n){return{Hub:n.H,Method:n.M,Args:n.A,State:n.S}},t.fn._registerSubscribedHubs=function(){var t=this;t._subscribedToHubs||(t._subscribedToHubs=!0,t.starting(function(){var i=[];n.each(t.proxies,function(n){this.hasSubscriptions()&&(i.push({name:n}),t.log("Client subscribed to hub '"+n+"'."))}),i.length===0&&t.log("No hubs have been subscribed to.  The client will not receive data from hubs.  To fix, declare at least one client side function prior to connection start for each hub you wish to subscribe to."),t.data=t.json.stringify(i)}))},t.fn.createHubProxy=function(n){n=n.toLowerCase();var t=this.proxies[n];return t||(t=i(this,n),this.proxies[n]=t),this._registerSubscribedHubs(),t},t.fn.init.prototype=t.fn,n.hubConnection=t}(window.jQuery,window),function(n){n.signalR.version="2.2.1"}(window.jQuery),function(){var n=$.hubConnection(),i=n.createHubProxy("chatHub"),t=null;MainConnection.prototype.getReadyState=function(){window.console&&window.console.debug&&window.console.debug("SignalR getReadyState enter");var t="",i={CONNECTING:0,CONNECTED:1,RECONNECTING:2,DISCONNECTED:4};if(n)switch(n.state){case i.CONNECTING:t="CONNECTING";break;case i.CONNECTED:t="OPEN";break;case i.DISCONNECTED:t="CLOSED";break;case i.RECONNECTING:t="RECONNECTING"}return t},MainConnection.prototype.hasPassedReconnect=!1,MainConnection.prototype.isExpertAgreeToConsult=!1,MainConnection.prototype.connect=function(){var u,r,e,f;MainConnection.prototype.isExpertAgreeToConsult=!1,window.console&&window.console.debug&&window.console.debug("SignalR connect enter"),u=function(n,t){MainConnection.OpSession.Process({MSG:{MSGDATA:t,MSGH:{MSGID:n}}})};try{MainConnection.chat=i,MainConnection.connnectionState="CONNECTING",n.url=MainConnection.ServerAddress,n.logging=MainConnection.ConsoleTrace,n.connectionSlow(function(){console.log("SignalR: We are currently experiencing difficulties with the connection."),u(3002)}),n.error(function(n){ChatLog.log(ChatLogEvents.wsErrorEvent,"OnErrorEvent: "+JSON.stringify(n)+", ConnectionDetails = "+formatJsonData(MainConnection.prototype.GetConnectionDetails())),ChatClientEvents.CommunicationError()}),n.disconnected(function(n){MainConnection.prototype.Trace("Connection has been closed."),MainConnection.connnectionState="CLOSED",Session.SendTextTimer&&clearInterval(Session.SendTextTimer),Session.prototype.ClosedSessionMessageSent||ChatClientEvents.CommunicationError(),t!=null&&t(),ChatLog.log(ChatLogEvents.wsGeneralEvent,"OnCloseEvent: "+JSON.stringify(n))}),r={settings:{maximumNumberOfRetry:1,currentNumberOfRetry:0},metrics:{ENABLE_LOGGING:!1,isPerformanceApiSupported:function(){return typeof performance!="undefined"&&performance!=null&&performance.now?!0:!1}(),log:function(n,t){r.metrics.ENABLE_LOGGING&&(console.warn("Using performance.now: "+r.metrics.isPerformanceApiSupported),console.warn("Event Name: "+n+", Time: "+t),console.warn(new Date))},startTime:0,endTime:0,measureTime:function(n){try{var t=r.metrics.isPerformanceApiSupported?performance.now():+new Date;return r.metrics.log(n,t),t}catch(i){}},start:function(){r.metrics.startTime=r.metrics.measureTime("start")},end:function(){r.metrics.endTime=r.metrics.measureTime("end")},duration:function(){var n=(r.metrics.endTime-r.metrics.startTime)/1e3;return r.metrics.log("duration",n),n}}},n.starting(function(){r.metrics.start(),MainConnection.prototype.Trace("Starting sending data...")}),n.received(function(n){MainConnection.prototype.Trace("Data received: "+n)}),n.reconnecting(function(n){MainConnection.prototype.Trace("reconnecting event"+n),u(3e3)}),n.reconnected(function(n){MainConnection.prototype.Trace("reconnected event"+n),u(3001)}),n.stateChanged(function(n){MainConnection.prototype.Trace("stateChanged event - newState: "+n.newState)});MainConnection.chat.on("onMessage",function(n){var t=JSON.parse(n);MainConnection.prototype.Trace("Message received = "+JSON.stringify(t));try{MainConnection.OperationsMap[t.MSG.MSGH.MSGID].Process(t)}catch(i){MainConnection.prototype.SendError("Unhandled Message "+t.MSG.MSGH.MSGID)}});MainConnection.chat.on("close",function(){try{ChatClientEvents.CommunicationError()}catch(t){MainConnection.prototype.SendError("Unhandled exception while Server asked to close the connection")}});$.connection.fn.log=function(t){try{if(n.logging){var i="SignalR "+t;console.log(i),typeof Logger!="undefined"&&Logger.saveLogToQueue&&Logger.saveLogToQueue(i)}}catch(r){}},e={waitForPageLoad:!1},f=function(){n.start(e).done(function(){r.metrics.end(),$(function(){MainConnection.OpLogin.SendRequest();try{typeof ChatLog!="undefined"&&typeof ChatLog.data!="undefined"&&(ChatLog.data.connectionStarted=!0,ChatLog.data.connectionStartDuration=r.metrics.duration(),ChatLog.data.startRetryNumber=r.settings.currentNumberOfRetry,ChatLog.data.connectionId=n.id,ChatLog.data.baseUrl=n.baseUrl,ChatLog.data.transportName=n.transport.name),ChatLog.log(ChatLogEvents.connectionStartSuccess)}catch(t){}})}).fail(function(n){r.settings.currentNumberOfRetry<r.settings.maximumNumberOfRetry?(r.settings.currentNumberOfRetry++,f()):(r.metrics.end(),$(function(){ChatLog.log(ChatLogEvents.wsErrorEvent,"Could not connect"+(typeof n!="undefined"&&n.message?": "+n.message:"")),ChatServerEvents.Alert("ERROR: Your browser could not connect to the chat. Please check your network signal."),MainConnection.prototype.SendError("ERROR: Your browser could not connect to the chat. Please check your network signal.");try{typeof ChatLog!="undefined"&&typeof ChatLog.data!="undefined"&&(ChatLog.data.connectionStarted=!1,ChatLog.data.connectionStartDuration=r.metrics.duration(),ChatLog.data.startRetryNumber=r.settings.currentNumberOfRetry),ChatLog.log(ChatLogEvents.connectionStartFailure)}catch(t){}}))})},f()}catch(o){MainConnection.prototype.SendError(o.message),ChatClientEvents.CommunicationError()}},MainConnection.prototype.GetConnectionDetails=function(){return{WebSocketState:MainConnection.prototype.getReadyState(),WebSocketBufferedAmount:-1,RecievedSessionClosed:Session.prototype.Closed}},MainConnection.prototype.CloseConnection=function(){MainConnection.prototype.Trace("SignalR Closing connection..."),Session.prototype.Closed=!0,Session.prototype.ClosedSessionMessageSent=!0;var i={CONNECTING:0,CONNECTED:1,RECONNECTING:2,DISCONNECTED:4},r=MainConnection.prototype.GetConnectionDetails(),t="";if(MainConnection.chat)switch(n.state){case i.CONNECTING:t="Socket is connecting for some unexpected reason, connection closed by client.",n.stop(!1);break;case i.RECONNECTING:t="Socket is reconnecting for some unexpected reason, connection closed by client.",n.stop(!1);break;case i.CONNECTED:t="Socket was open, connection closed by client.",n.stop(!1);break;case i.DISCONNECTED:t="Socket is already closed or in closing state."}ChatLog.log(ChatLogEvents.wsGeneralEvent,t+" | ConnectionDetails = "+formatJsonData(r))},MainConnection.prototype.RunActionOnDisconnected=function(n){t=n},MainConnection.prototype.SendMessage=function(n){MainConnection.prototype.Trace("SignalR Sending message...");var t=JSON.stringify(n);return MainConnection.chat!=null&&MainConnection.prototype.getReadyState()==="OPEN"?(Session.prototype.LastMsg=t,MainConnection.chat.invoke("send",t).done(function(){MainConnection.prototype.Trace("Message sent = "+t),Session.prototype.Closed&&(ChatLog.log(ChatLogEvents.wsErrorEvent,"Message sent while session already ended! | ConnectionDetails = "+formatJsonData(MainConnection.prototype.GetConnectionDetails())),MainConnection.prototype.CloseConnection())}).fail(function(n){var i="Message unsent ("+n+")";MainConnection.prototype.Trace(i+" = "+t),ChatLog.log(ChatLogEvents.wsErrorEvent,i+" | Error = "+n+" | ConnectionDetails = "+formatJsonData(MainConnection.prototype.GetConnectionDetails()))}),!0):!1},MainConnection.prototype.SendError=function(n){console.log(n),ChatLog.chatType=ChatType.Html5,ChatLog.log(ChatLogEvents.generalErrorEvent,n)},MainConnection.prototype.Trace=function(n){MainConnection.ConsoleTrace=="True"&&console.log&&console.log(n)}}(),function(n){n.prototype.MsgCode.Reconnecting=3e3,n.prototype.MsgCode.Reconnected=3001,n.prototype.MsgCode.Slow_Connection=3002;var i=new Date,t=new Date;n.prototype.GetReconnectingDiff=function(n,t){var i=t.getTime()-n.getTime(),r=i/1e3;return Math.abs(r)},n.prototype.Process=function(r){var u,f;try{switch(Number(r.MSG.MSGH.MSGID)){case n.prototype.MsgCode.Chat_Text_Line:u=r.MSG.MSGH.SOURCE=="1"?!0:null,ChatServerEvents.OnExpertMessage(r.MSG.MSGDATA.TEXT,u),r.MSG.MSGDATA.AUTO_HIRE_EXPERT=="1"&&(console.log("AUTO_HIRE_EXPERT: hireEvent"),n.prototype.hireEvent("AUTO_HIRE_EXPERT"));break;case n.prototype.MsgCode.Expert_Fee:ChatServerEvents.OnFeeChanged(r.MSG.MSGDATA.TEXT);break;case n.prototype.MsgCode.Hire_Confirmed:ChatServerEvents.OnHire(),ChatLog.log(ChatLogEvents.hireConfirmed);break;case n.prototype.MsgCode.Hire_denied:ChatLog.log(ChatLogEvents.hireDenied),ChatServerEvents.Alert(r.MSG.MSGDATA.TEXT);break;case n.prototype.MsgCode.BAH_Show_CC_Form:ChatServerEvents.Alert("You cannot hire this expert because there is no payment method available. You have to quit the session and make a deposit into your account first.");break;case n.prototype.MsgCode.Session_Closed:clearInterval(n.SendTextTimer),n.prototype.ClosedSessionMessageSent=!0,r.MSG.MSGDATA?ChatLog.log(ChatLogEvents.sessionClosed,"Reason Id: "+r.MSG.MSGDATA.CLOSURE_REASON):(ChatLog.log(ChatLogEvents.sessionClosed,"Empty Closure Reason"),r.MSG.MSGDATA={CLOSURE_REASON:"9"}),ChatServerEvents.OnSessionClosed(r.MSG.MSGDATA.CLOSURE_REASON),MainConnection.prototype.CloseConnection();break;case n.prototype.MsgCode.Expert_Close_Session:clearInterval(n.SendTextTimer),ChatServerEvents.OnSessionClosed("4"),MainConnection.prototype.CloseConnection(),ChatLog.log(ChatLogEvents.expertClosedSession);break;case n.prototype.MsgCode.Expert_Agree_To_Consult:MainConnection.prototype.isExpertAgreeToConsult=!0,n.SendTextTimer=setInterval(n.prototype.onTimerSendText,3e3),n.prototype.ProcessFreeMinutes(n.FreeMinutes),ChatServerEvents.OnExpertAgreeToConsult(r.MSG.MSGH.DEST),ChatServerEvents.OnAgreeToConsult(r.MSG.MSGH.DEST,n.FreeMinutes);break;case n.prototype.MsgCode.Try_Later_Server_Closing:ChatServerEvents.OnSessionClosed("6"),ChatServerEvents.OnServerClosingTryLater(),clearInterval(n.SendTextTimer),MainConnection.prototype.CloseConnection();break;case n.prototype.MsgCode.CLOSING_SERVER:ChatServerEvents.OnSessionClosed("6"),ChatServerEvents.OnServerClosingTryLater(),clearInterval(n.SendTextTimer),MainConnection.prototype.CloseConnection(),ChatLog.log(ChatLogEvents.serverIsClosing);break;case n.prototype.MsgCode.Reconnecting:ChatServerEvents.OnReconnecting(),i=new Date;break;case n.prototype.MsgCode.Reconnected:ChatServerEvents.OnReconnected(),t=new Date,f=n.prototype.GetReconnectingDiff(i,t),ChatLog.log(ChatLogEvents.connectionReconnected,"Time from reconnecting to reconnected is: "+f+" at: "+t);break;case n.prototype.MsgCode.Slow_Connection:ChatServerEvents.OnSlowConnection(),ChatLog.log(ChatLogEvents.connectionSlow);break;default:MainConnection.prototype.SendError("Session Method not implemented: "+r.MSG.MSGH.MSGID)}}catch(e){MainConnection.prototype.SendError(e.message)}}}(Session)
